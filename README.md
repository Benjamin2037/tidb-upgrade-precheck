# tidb-upgrade-precheck

`tidb-upgrade-precheck` provides a lightweight Go library and CLI that perform consistent parameter and configuration validation before a TiDB cluster upgrade. The goal is to share one rule set and risk model between TiUP CLI, TiOperator, and other automation entry points.

## Key Features

- **Unified abstractions**: defines the core `Snapshot`, `Rule`, and `Report` types so different front-ends can plug in the same engine.
- **Extensible rule catalog**: ships with baseline checks and allows additional rules or external knowledge bases (for example, JSON produced by `paramguard`).
- **Structured reporting**: produces machine-friendly `Report` documents that can be rendered in terminals, returned from APIs, or persisted for auditing.
- **Reference CLI**: `cmd/precheck` shows how to wire the engine to a simple command that consumes a snapshot JSON file.

## Quick Start

```bash
# Install the CLI
go install ./cmd/precheck

# Run the sample
precheck --snapshot examples/minimal_snapshot.json
```

## Project Layout

```
cmd/precheck        # reference CLI
pkg/precheck        # core engine and shared types
pkg/rules           # built-in rule implementations
examples            # sample inputs
```

## Roadmap

- Integrate the versioned knowledge base generated by `paramguard` so forced changes and defaults load automatically.
- Provide a Kubernetes adapter for TiOperator and other controllers.
- Grow the rule catalog to cover hardware checks, dependency validation, configuration conflicts, and more.

Issues and pull requests are welcome.