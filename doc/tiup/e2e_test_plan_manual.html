<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TiUP Cluster Upgrade E2E 测试计划</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f5f5;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            padding: 30px;
        }
        
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        
        h2 {
            color: #34495e;
            margin-top: 30px;
            margin-bottom: 15px;
            padding: 10px;
            background: #ecf0f1;
            border-left: 4px solid #3498db;
        }
        
        h3 {
            color: #555;
            margin-top: 25px;
            margin-bottom: 15px;
            cursor: pointer;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 4px;
            transition: background 0.2s;
        }
        
        h3:hover {
            background: #e9ecef;
        }
        
        h4 {
            color: #666;
            margin-top: 20px;
            margin-bottom: 10px;
            padding: 8px;
            background: #f0f0f0;
            border-left: 3px solid #95a5a6;
        }
        
        .phase {
            margin-bottom: 30px;
            border: 1px solid #ddd;
            border-radius: 6px;
            padding: 20px;
            background: #fafafa;
        }
        
        .test {
            margin-bottom: 20px;
            padding: 15px;
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
        }
        
        .test-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .test-checkbox {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }
        
        .command-block {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 4px;
            margin: 10px 0;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 13px;
            line-height: 1.5;
            overflow-x: auto;
            position: relative;
        }
        
        .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #3498db;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .copy-btn:hover {
            background: #2980b9;
        }
        
        .checkpoint {
            margin: 10px 0;
            padding: 10px;
            background: #f9f9f9;
            border-left: 3px solid #95a5a6;
            border-radius: 3px;
        }
        
        .checkpoint-item {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            margin: 8px 0;
        }
        
        .checkpoint-checkbox {
            width: 18px;
            height: 18px;
            margin-top: 3px;
            cursor: pointer;
        }
        
        .checkpoint-text {
            flex: 1;
        }
        
        .remark-input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin-top: 5px;
            font-size: 13px;
            min-height: 60px;
        }
        
        .remark-display {
            margin-top: 5px;
            padding: 8px;
            background: #fff3cd;
            border-left: 3px solid #ffc107;
            border-radius: 3px;
            font-size: 13px;
        }
        
        .progress-bar {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: #e0e0e0;
            z-index: 1000;
        }
        
        .progress-fill {
            height: 100%;
            background: #3498db;
            transition: width 0.3s;
        }
        
        .stats {
            position: fixed;
            top: 10px;
            right: 20px;
            background: white;
            padding: 15px;
            border-radius: 6px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            z-index: 999;
        }
        
        .stats-item {
            margin: 5px 0;
            font-size: 14px;
        }
        
        .stats-number {
            font-weight: bold;
            color: #3498db;
        }
        
        .collapsible {
            cursor: pointer;
        }
        
        .collapsible::before {
            content: '▼ ';
            display: inline-block;
            transition: transform 0.2s;
        }
        
        .collapsible.collapsed::before {
            transform: rotate(-90deg);
        }
        
        .collapsed-content {
            display: block;
        }
        
        .save-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #27ae60;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }
        
        .save-btn:hover {
            background: #229954;
        }
        
        .save-indicator {
            position: fixed;
            bottom: 70px;
            right: 20px;
            background: #27ae60;
            color: white;
            padding: 8px 16px;
            border-radius: 4px;
            font-size: 12px;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .save-indicator.show {
            opacity: 1;
        }
        
        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
    </div>
    
    <div class="stats" id="stats">
        <div class="stats-item">总测试: <span class="stats-number" id="totalTests">0</span></div>
        <div class="stats-item">已完成: <span class="stats-number" id="completedTests">0</span></div>
        <div class="stats-item">进度: <span class="stats-number" id="progressPercent">0%</span></div>
    </div>
    
    <div class="container">
        <h1>TiUP Cluster Upgrade E2E 测试计划（手动执行）</h1>
        <p style="margin-bottom: 20px; color: #666;">本文档提供详细的端到端测试计划，使用真实的 <code>tiup cluster upgrade</code> 命令测试完整的升级场景。</p>
        
        <h2>测试目标</h2>
        <ul style="margin-left: 20px; margin-bottom: 20px;">
            <li>验证 <code>tiup cluster upgrade --precheck</code> 命令正常工作</li>
            <li>验证 <code>tiup cluster upgrade</code> 默认行为（自动运行 precheck）</li>
            <li>验证所有 precheck 相关参数正常工作</li>
            <li>验证报告生成和显示</li>
            <li>验证完整升级流程中的 precheck 集成</li>
            <li>验证错误处理和边界情况</li>
        </ul>
        
        <h2>前置条件</h2>

        <div class="phase">
            <h3 class="collapsible" onclick="toggleSection(this)">1. 环境准备</h3>
            <div class="collapsed-content">

                <div class="command-block">
                    <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                    <pre># 1.5.1 安装基础依赖（Debian/Ubuntu）
sudo apt update
sudo apt install -y git curl wget tar bash ca-certificates rsync sudo     build-essential golang openssh-server
sudo systemctl enable --now ssh

# 1.5.2 克隆代码
mkdir -p ~/workspace && cd ~/workspace
git clone git@github.com:Benjamin2037/tidb-upgrade-precheck.git
git clone git@github.com:Benjamin2037/tiup.git

# 1.5.3 构建 tidb-upgrade-precheck
cd ~/workspace/tidb-upgrade-precheck
GOWORK=off go build -o bin/upgrade-precheck ./cmd/precheck

# 1.5.4 构建 tiup-cluster（使用本地 precheck 作为 replace）
cd ~/workspace/tiup
git checkout precheck-dev-qwen
sed -i 's|replace github.com/pingcap/tidb-upgrade-precheck .*|replace github.com/pingcap/tidb-upgrade-precheck => ../tidb-upgrade-precheck|' go.mod
GOWORK=off go mod tidy
GOWORK=off go build -ldflags '-w -s' -o bin/tiup-cluster ./components/cluster

# 1.5.5 设置环境变量（当前 shell 会话）
export TIDB_UPGRADE_PRECHECK_BIN=~/workspace/tidb-upgrade-precheck/bin/upgrade-precheck
export TIDB_UPGRADE_PRECHECK_KB=~/workspace/tidb-upgrade-precheck/knowledge
export PATH=~/workspace/tiup/bin:$PATH

# 1.5.6 准备拓扑文件（/tmp/e2e-test-topology.yaml，使用当前登录用户）
cat > /tmp/e2e-test-topology.yaml <<'EOF'
global:
  user: "<你的登录用户名>"
  ssh_port: 22
  deploy_dir: "/data/tidb-deploy"
  data_dir: "/data/tidb-data"

pd_servers:
  - host: 127.0.0.1
    name: pd1
    client_port: 2379
    peer_port: 2380

tidb_servers:
  - host: 127.0.0.1
    port: 4000
    status_port: 10080

tikv_servers:
  - host: 127.0.0.1
    port: 20160
    status_port: 20180

tiflash_servers:
  - host: 127.0.0.1
    data_dir: "/data/tidb-data/tiflash-9000"
    tcp_port: 9000
    http_port: 8123
    flash_service_port: 3930
    flash_proxy_port: 20170
    flash_proxy_status_port: 20292
EOF

# 确保 /data 可写
sudo mkdir -p /data && sudo chown -R $(whoami):$(whoami) /data

# 1.5.7 部署与启动
tiup_bin=~/workspace/tiup/bin/tiup-cluster
$tiup_bin deploy e2e-test-cluster v7.5.1 /tmp/e2e-test-topology.yaml -y
$tiup_bin start e2e-test-cluster
$tiup_bin display e2e-test-cluster

# 1.5.8 升级前检查（显式指定 precheck）
$tiup_bin upgrade e2e-test-cluster v8.5.2 --precheck   --precheck-bin $TIDB_UPGRADE_PRECHECK_BIN   --precheck-kb $TIDB_UPGRADE_PRECHECK_KB   --yes</pre>
                </div>
<h4>验证点</h4>

                <div class="checkpoint">
                    <div class="checkpoint-item">
                        <input type="checkbox" class="checkpoint-checkbox" data-id="prep-1-cp1" onchange="updateProgress()">
                        <div class="checkpoint-text">
                            <strong>tidb-upgrade-precheck 二进制存在且可执行（验证 1.2 步骤的编译结果）</strong>
                            
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>ls -lh /home/bearc/workspace/sourcecode/tidb-upgrade-precheck/bin/upgrade-precheck
  /home/bearc/workspace/sourcecode/tidb-upgrade-precheck/bin/upgrade-precheck --help | head -5</pre>
                            </div>

                            <textarea class="remark-input" placeholder="添加备注..." data-id="prep-1-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                            <div class="remark-display" data-id="prep-1-cp1-remark-display" style="display: none;"></div>
                        </div>
                    </div>
                </div>

                <div class="checkpoint">
                    <div class="checkpoint-item">
                        <input type="checkbox" class="checkpoint-checkbox" data-id="prep-1-cp2" onchange="updateProgress()">
                        <div class="checkpoint-text">
                            <strong>tiup-cluster 二进制存在且可执行（验证 1.3 步骤的编译结果）</strong>
                            
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>ls -lh /home/bearc/workspace/sourcecode/tiup/bin/tiup-cluster
  /home/bearc/workspace/sourcecode/tiup/bin/tiup-cluster --help | head -5</pre>
                            </div>

                            <textarea class="remark-input" placeholder="添加备注..." data-id="prep-1-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                            <div class="remark-display" data-id="prep-1-cp2-remark-display" style="display: none;"></div>
                        </div>
                    </div>
                </div>

                <div class="checkpoint">
                    <div class="checkpoint-item">
                        <input type="checkbox" class="checkpoint-checkbox" data-id="prep-1-cp3" onchange="updateProgress()">
                        <div class="checkpoint-text">
                            <strong>环境变量正确设置（**注意：必须先执行 1.4 步骤的 export 命令，或在同一个 shell 会话中执行**）</strong>
                            
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 如果环境变量未设置，先执行以下命令：
  export TIDB_UPGRADE_PRECHECK_BIN=/home/bearc/workspace/sourcecode/tidb-upgrade-precheck/bin/upgrade-precheck
  export TIDB_UPGRADE_PRECHECK_KB=/home/bearc/workspace/sourcecode/tidb-upgrade-precheck/knowledge
  
  # 然后验证环境变量
  echo "TIDB_UPGRADE_PRECHECK_BIN: $TIDB_UPGRADE_PRECHECK_BIN"
  echo "TIDB_UPGRADE_PRECHECK_KB: $TIDB_UPGRADE_PRECHECK_KB"
  [ -n "$TIDB_UPGRADE_PRECHECK_BIN" ] && [ -n "$TIDB_UPGRADE_PRECHECK_KB" ] && echo "✓ Environment variables set" || echo "✗ Environment variables not set"</pre>
                            </div>

                            <textarea class="remark-input" placeholder="添加备注..." data-id="prep-1-cp3-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                            <div class="remark-display" data-id="prep-1-cp3-remark-display" style="display: none;"></div>
                        </div>
                    </div>
                </div>

                <div class="checkpoint">
                    <div class="checkpoint-item">
                        <input type="checkbox" class="checkpoint-checkbox" data-id="prep-1-cp4" onchange="updateProgress()">
                        <div class="checkpoint-text">
                            <strong>知识库目录存在（**注意：如果环境变量未设置，使用绝对路径验证**）</strong>
                            
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 如果环境变量已设置，使用：
  ls -d "$TIDB_UPGRADE_PRECHECK_KB" && echo "✓ KB directory exists" || echo "✗ KB directory not found"
  
  # 如果环境变量未设置，使用绝对路径：
  ls -d /home/bearc/workspace/sourcecode/tidb-upgrade-precheck/knowledge && echo "✓ KB directory exists" || echo "✗ KB directory not found"</pre>
                            </div>

                            <textarea class="remark-input" placeholder="添加备注..." data-id="prep-1-cp4-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                            <div class="remark-display" data-id="prep-1-cp4-remark-display" style="display: none;"></div>
                        </div>
                    </div>
                </div>

                <div class="checkpoint">
                    <div class="checkpoint-item">
                        <input type="checkbox" class="checkpoint-checkbox" data-id="prep-1-cp5" onchange="updateProgress()">
                        <div class="checkpoint-text">
                            <strong>`bin/upgrade-precheck` 可执行</strong>
                            
                            <textarea class="remark-input" placeholder="添加备注..." data-id="prep-1-cp5-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                            <div class="remark-display" data-id="prep-1-cp5-remark-display" style="display: none;"></div>
                        </div>
                    </div>
                </div>

                <div class="checkpoint">
                    <div class="checkpoint-item">
                        <input type="checkbox" class="checkpoint-checkbox" data-id="prep-1-cp6" onchange="updateProgress()">
                        <div class="checkpoint-text">
                            <strong>`bin/tiup-cluster` 可执行</strong>
                            
                            <textarea class="remark-input" placeholder="添加备注..." data-id="prep-1-cp6-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                            <div class="remark-display" data-id="prep-1-cp6-remark-display" style="display: none;"></div>
                        </div>
                    </div>
                </div>

                <div class="checkpoint">
                    <div class="checkpoint-item">
                        <input type="checkbox" class="checkpoint-checkbox" data-id="prep-1-cp7" onchange="updateProgress()">
                        <div class="checkpoint-text">
                            <strong>环境变量已设置（`echo $TIDB_UPGRADE_PRECHECK_BIN`）</strong>
                            
                            <textarea class="remark-input" placeholder="添加备注..." data-id="prep-1-cp7-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                            <div class="remark-display" data-id="prep-1-cp7-remark-display" style="display: none;"></div>
                        </div>
                    </div>
                </div>

                <div class="checkpoint">
                    <div class="checkpoint-item">
                        <input type="checkbox" class="checkpoint-checkbox" data-id="prep-1-cp8" onchange="updateProgress()">
                        <div class="checkpoint-text">
                            <strong>`/data/tidb-deploy` 与 `/data/tidb-data` 可写</strong>
                            
                            <textarea class="remark-input" placeholder="添加备注..." data-id="prep-1-cp8-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                            <div class="remark-display" data-id="prep-1-cp8-remark-display" style="display: none;"></div>
                        </div>
                    </div>
                </div>

                <div class="checkpoint">
                    <div class="checkpoint-item">
                        <input type="checkbox" class="checkpoint-checkbox" data-id="prep-1-cp9" onchange="updateProgress()">
                        <div class="checkpoint-text">
                            <strong>`tiup-cluster deploy/start/display` 正常，无 systemd 缺失错误</strong>
                            
                            <textarea class="remark-input" placeholder="添加备注..." data-id="prep-1-cp9-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                            <div class="remark-display" data-id="prep-1-cp9-remark-display" style="display: none;"></div>
                        </div>
                    </div>
                </div>

                <div class="checkpoint">
                    <div class="checkpoint-item">
                        <input type="checkbox" class="checkpoint-checkbox" data-id="prep-1-cp10" onchange="updateProgress()">
                        <div class="checkpoint-text">
                            <strong>`tiup-cluster upgrade --precheck` 运行成功或输出预期检查结果</strong>
                            
                            <textarea class="remark-input" placeholder="添加备注..." data-id="prep-1-cp10-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                            <div class="remark-display" data-id="prep-1-cp10-remark-display" style="display: none;"></div>
                        </div>
                    </div>
                </div>
</div></div>

        <div class="phase">
            <h3 class="collapsible" onclick="toggleSection(this)">2. 知识库准备</h3>
            <div class="collapsed-content">

                <div class="command-block">
                    <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                    <pre>cd /home/bearc/workspace/sourcecode/tidb-upgrade-precheck

# 检查知识库
ls -d knowledge/v7.5/v7.5.1 knowledge/v8.5/v8.5.4 2>/dev/null || echo "需要生成知识库"

# 如果不存在，生成知识库（可以混合使用两种方式）

# 重要：先确保 upgrade_logic.json 已生成（TiDB 模块的强制变更逻辑）
# upgrade_logic.json 是全局文件，包含所有历史版本的升级逻辑，需要从 master/main 分支提取
# 方式 A: 使用 generate_knowledge.sh 的 --force 模式会自动生成（推荐）
# bash scripts/generate_knowledge.sh --force --serial --start-from=v7.5.1 --stop-at=v7.5.1

# 方式 B: 单独生成 upgrade_logic.json（如果需要强制重新生成）
# 注意：需要先切换到 TiDB 仓库的 master/main 分支
# cd /home/bearc/workspace/sourcecode/tidb
# git checkout master  # 或 git checkout main
# cd ../tidb-upgrade-precheck
# mkdir -p knowledge/tidb
# GOWORK=off go run cmd/generate_upgrade_logic/main.go \
#   --tidb-repo=/home/bearc/workspace/sourcecode/tidb \
#   --output=knowledge/tidb/upgrade_logic.json

# 方式 1: 使用 generate_knowledge.sh 脚本生成 v7.5.1（批量生成方式）
# bash scripts/generate_knowledge.sh --serial --start-from=v7.5.1 --stop-at=v7.5.1

# 方式 2: 直接使用 kb_generator 生成 v8.5.4（单个版本，使用 --version 参数）
# GOWORK=off go run cmd/kb_generator/main.go --version=v8.5.4 --components=tidb,pd,tikv,tiflash

# 或者反过来：
# 方式 2: 使用 kb_generator 生成 v7.5.1
# GOWORK=off go run cmd/kb_generator/main.go --version=v7.5.1 --components=tidb,pd,tikv,tiflash
# 方式 1: 使用 generate_knowledge.sh 生成 v8.5.4
# bash scripts/generate_knowledge.sh --serial --start-from=v8.5.4 --stop-at=v8.5.4</pre>
                </div>
<h4>验证点</h4>

                <div class="checkpoint">
                    <div class="checkpoint-item">
                        <input type="checkbox" class="checkpoint-checkbox" data-id="prep-2-cp1" onchange="updateProgress()">
                        <div class="checkpoint-text">
                            <strong>源版本知识库存在（v7.5.1）</strong>
                            
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>ls -d knowledge/v7.5/v7.5.1 && echo "✓ Source version KB exists" || echo "✗ Source version KB not found"</pre>
                            </div>

                            <textarea class="remark-input" placeholder="添加备注..." data-id="prep-2-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                            <div class="remark-display" data-id="prep-2-cp1-remark-display" style="display: none;"></div>
                        </div>
                    </div>
                </div>

                <div class="checkpoint">
                    <div class="checkpoint-item">
                        <input type="checkbox" class="checkpoint-checkbox" data-id="prep-2-cp2" onchange="updateProgress()">
                        <div class="checkpoint-text">
                            <strong>目标版本知识库存在（v8.5.4）</strong>
                            
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>ls -d knowledge/v8.5/v8.5.4 && echo "✓ Target version KB exists" || echo "✗ Target version KB not found"</pre>
                            </div>

                            <textarea class="remark-input" placeholder="添加备注..." data-id="prep-2-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                            <div class="remark-display" data-id="prep-2-cp2-remark-display" style="display: none;"></div>
                        </div>
                    </div>
                </div>

                <div class="checkpoint">
                    <div class="checkpoint-item">
                        <input type="checkbox" class="checkpoint-checkbox" data-id="prep-2-cp3" onchange="updateProgress()">
                        <div class="checkpoint-text">
                            <strong>所有组件 defaults.json 文件存在</strong>
                            
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>for version in "v7.5/v7.5.1" "v8.5/v8.5.4"; do
    for comp in tidb pd tikv tiflash; do
      if [ -f "knowledge/$version/$comp/defaults.json" ]; then
        echo "✓ $version/$comp/defaults.json"
      else
        echo "✗ $version/$comp/defaults.json MISSING"
      fi
    done
  done</pre>
                            </div>

                            <textarea class="remark-input" placeholder="添加备注..." data-id="prep-2-cp3-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                            <div class="remark-display" data-id="prep-2-cp3-remark-display" style="display: none;"></div>
                        </div>
                    </div>
                </div>

                <div class="checkpoint">
                    <div class="checkpoint-item">
                        <input type="checkbox" class="checkpoint-checkbox" data-id="prep-2-cp4" onchange="updateProgress()">
                        <div class="checkpoint-text">
                            <strong>TiDB upgrade_logic.json 文件存在（包含强制变更逻辑）</strong>
                            
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>if [ -f "knowledge/tidb/upgrade_logic.json" ]; then
    echo "✓ upgrade_logic.json exists"
    echo "  File size: $(ls -lh knowledge/tidb/upgrade_logic.json | awk '{print $5}')"
    echo "  Forced changes count: $(cat knowledge/tidb/upgrade_logic.json | grep -o '"type":"force"' | wc -l | tr -d ' ')"
  else
    echo "✗ upgrade_logic.json MISSING"
    echo "  Run: GOWORK=off go run cmd/generate_upgrade_logic/main.go --tidb-repo=<tidb-repo-path> --output=knowledge/tidb/upgrade_logic.json"
  fi</pre>
                            </div>

                            <textarea class="remark-input" placeholder="添加备注..." data-id="prep-2-cp4-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                            <div class="remark-display" data-id="prep-2-cp4-remark-display" style="display: none;"></div>
                        </div>
                    </div>
                </div>
</div></div>

        <div class="phase">
            <h3 class="collapsible" onclick="toggleSection(this)">3. 测试集群准备</h3>
            <div class="collapsed-content">

                <div class="command-block">
                    <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                    <pre># 3.1 创建测试拓扑文件
# 注意：此拓扑文件只包含核心组件（pd、tidb、tikv、tiflash）
# 不包含任何监控组件（monitoring_servers、grafana_servers、alertmanager_servers、node_exporter、blackbox_exporter）
# 这样可以避免在 macOS ARM64 平台上遇到监控组件不支持的问题
# 对于 E2E 测试，核心组件已经足够，不需要监控组件
cat > /tmp/e2e-test-topology.yaml << 'EOF'
global:
  user: "tidb"
  ssh_port: 22
  deploy_dir: "/tmp/tidb-deploy"
  data_dir: "/tmp/tidb-data"

pd_servers:
  - host: 127.0.0.1
    name: pd1
    client_port: 2379
    peer_port: 2380

tidb_servers:
  - host: 127.0.0.1
    port: 4000
    status_port: 10080

tikv_servers:
  - host: 127.0.0.1
    port: 20160
    status_port: 20180

tiflash_servers:
  - host: 127.0.0.1
    data_dir: "/tmp/tidb-data/tiflash-9000"
    tcp_port: 9000
    http_port: 8123
    flash_service_port: 3930
    flash_proxy_port: 20170
    flash_proxy_status_port: 20292
    # 注意：TiFlash 不使用 status_port 字段，已移除

# 注意：
# 1. 只包含核心组件：pd、tidb、tikv、tiflash（用于 E2E 测试已足够）
# 2. 不包含任何监控组件：
#    - 不包含 monitoring_servers（node_exporter、blackbox_exporter）
#    - 不包含 grafana_servers
#    - 不包含 alertmanager_servers
# 3. 这样可以避免在 macOS ARM64 平台上遇到监控组件不支持的问题
# 4. 对于 E2E 测试，核心组件已经足够，不需要监控组件
# 5. 如果仍遇到监控组件下载错误，请参考"故障排除 - 问题 0"
EOF

# 3.2 部署测试集群（如果不存在）
# 注意：确保使用本地构建的 tiup-cluster 二进制，或确保系统 tiup 已正确配置
# 注意：拓扑文件只包含核心组件（pd、tidb、tikv、tiflash），不包含任何监控组件
CLUSTER_NAME="e2e-test-cluster"

# 检查集群是否已存在
echo "检查集群 $CLUSTER_NAME 是否存在..."
if tiup cluster list 2>/dev/null | grep -q "^$CLUSTER_NAME"; then
    echo "✓ 集群 $CLUSTER_NAME 已存在，跳过部署"
else
    echo "集群 $CLUSTER_NAME 不存在，开始部署..."
    
    # 验证拓扑文件是否存在
    if [ ! -f "/tmp/e2e-test-topology.yaml" ]; then
        echo "✗ 错误: 拓扑文件不存在: /tmp/e2e-test-topology.yaml"
        echo "  请先执行 3.1 步骤创建拓扑文件"
        # 注意：不使用 exit，避免退出 shell 会话
    else
        echo "✓ 拓扑文件存在: /tmp/e2e-test-topology.yaml"
        
        # 清理可能存在的残留数据
        if [ -d "$HOME/.tiup/storage/cluster/clusters/$CLUSTER_NAME" ]; then
            echo "清理残留的集群数据..."
            rm -rf "$HOME/.tiup/storage/cluster/clusters/$CLUSTER_NAME"
        fi
        
        # 检测平台
        PLATFORM=$(uname -m)
        OS=$(uname -s)
        if [ "$OS" = "Darwin" ] && [ "$PLATFORM" = "arm64" ]; then
            echo "检测到 macOS ARM64 平台"
            echo "拓扑文件已配置为只包含核心组件，不包含监控组件"
        fi
        
        # 检查端口是否被占用
        echo "检查端口是否被占用..."
        PORTS_IN_USE=""
        for port in 4000 2379 20160 9000; do
            if lsof -i :$port > /dev/null 2>&1; then
                PORTS_IN_USE="$PORTS_IN_USE $port"
            fi
        done
        if [ -n "$PORTS_IN_USE" ]; then
            echo "⚠ 警告: 以下端口被占用: $PORTS_IN_USE"
            echo "  如果这些端口被其他 TiDB 集群占用，请先停止它们"
            echo "  或者修改拓扑文件中的端口配置"
        else
            echo "✓ 所有端口可用"
        fi
        
        # 使用本地构建的 tiup-cluster（推荐）
        DEPLOY_LOG="/tmp/deploy-${CLUSTER_NAME}-$(date +%Y%m%d-%H%M%S).log"
        if [ -f "./bin/tiup-cluster" ]; then
            echo "使用本地构建的 tiup-cluster 部署..."
            echo "部署日志: $DEPLOY_LOG"
            echo "执行命令: ./bin/tiup-cluster deploy $CLUSTER_NAME v7.5.1 /tmp/e2e-test-topology.yaml -y"
            
            # 执行部署命令并捕获输出
            ./bin/tiup-cluster deploy "$CLUSTER_NAME" v7.5.1 /tmp/e2e-test-topology.yaml -y > "$DEPLOY_LOG" 2>&1
            DEPLOY_EXIT_CODE=$?
            
            echo "部署命令退出码: $DEPLOY_EXIT_CODE"
            
            # 显示部署日志的最后部分（包含错误信息）
            echo ""
            echo "=== 部署日志（最后 50 行）==="
            tail -50 "$DEPLOY_LOG"
            echo "=============================="
            echo ""
            
            # 等待一下，让 TiUP 完成所有操作
            echo "等待 TiUP 完成操作..."
            sleep 3
            
            # 检查集群是否真正创建成功（这是最可靠的检查方式）
            echo "检查集群是否创建成功..."
            if tiup cluster list 2>/dev/null | grep -q "^$CLUSTER_NAME"; then
                echo "✓ 集群部署成功（集群已创建）"
                echo "集群列表:"
                tiup cluster list | grep "^$CLUSTER_NAME"
            else
                echo "✗ 集群部署失败：集群未创建"
                echo ""
                echo "  可能的原因："
                echo "  1. 部署过程中出现错误（即使拓扑文件只包含核心组件）"
                echo "  2. 端口被占用"
                echo "  3. 权限问题"
                echo "  4. TiUP 版本问题"
                echo ""
                echo "  排查步骤："
                echo "  1. 查看完整部署日志: cat $DEPLOY_LOG"
                echo "  2. 检查端口是否被占用: lsof -i :4000 -i :2379 -i :20160 -i :9000"
                echo "  3. 检查 TiUP 日志: ls -lt ~/.tiup/logs/ | head -5"
                echo "  4. 尝试手动部署（见下方手动部署步骤）"
                echo "  5. 参考'故障排除 - 问题 0'获取更多帮助"
                echo ""
                echo "⚠ 警告: 集群部署失败，请解决上述问题后重新执行部署命令"
                # 注意：不使用 exit，避免退出 shell 会话
            fi
        else
            # 如果本地二进制不存在，使用系统安装的 tiup
            echo "警告: 本地 tiup-cluster 不存在，使用系统 tiup"
            echo "部署日志: $DEPLOY_LOG"
            echo "执行命令: tiup cluster deploy $CLUSTER_NAME v7.5.1 /tmp/e2e-test-topology.yaml -y"
            
            tiup cluster deploy "$CLUSTER_NAME" v7.5.1 /tmp/e2e-test-topology.yaml -y > "$DEPLOY_LOG" 2>&1
            DEPLOY_EXIT_CODE=$?
            
            echo "部署命令退出码: $DEPLOY_EXIT_CODE"
            
            # 显示部署日志的最后部分
            echo ""
            echo "=== 部署日志（最后 50 行）==="
            tail -50 "$DEPLOY_LOG"
            echo "=============================="
            echo ""
            
            # 等待一下
            echo "等待 TiUP 完成操作..."
            sleep 3
            
            # 检查集群是否真正创建成功
            echo "检查集群是否创建成功..."
            if tiup cluster list 2>/dev/null | grep -q "^$CLUSTER_NAME"; then
                echo "✓ 集群部署成功（集群已创建）"
                echo "集群列表:"
                tiup cluster list | grep "^$CLUSTER_NAME"
            else
                echo "✗ 集群部署失败：集群未创建"
                echo ""
                echo "  排查步骤："
                echo "  1. 查看完整部署日志: cat $DEPLOY_LOG"
                echo "  2. 检查端口是否被占用: lsof -i :4000 -i :2379 -i :20160 -i :9000"
                echo "  3. 尝试手动部署（见下方手动部署步骤）"
                echo "  4. 参考'故障排除 - 问题 0'获取更多帮助"
                echo ""
                echo "⚠ 警告: 集群部署失败，请解决上述问题后重新执行部署命令"
                # 注意：不使用 exit，避免退出 shell 会话
            fi
        fi
        
        # 保留日志文件以便调试（不自动删除）
        echo ""
        echo "部署日志已保存到: $DEPLOY_LOG"
        echo "如需查看完整日志: cat $DEPLOY_LOG"
    fi
fi

# 手动部署步骤（如果自动部署失败，可以手动执行）
echo ""
echo "=========================================="
echo "手动部署步骤（如果自动部署失败）"
echo "=========================================="
echo "如果自动部署失败，可以手动执行以下命令："
echo ""
echo "1. 检查拓扑文件:"
echo "   cat /tmp/e2e-test-topology.yaml"
echo ""
echo "2. 手动部署集群:"
echo "   cd /home/bearc/workspace/sourcecode/tiup"
echo "   ./bin/tiup-cluster deploy e2e-test-cluster v7.5.1 /tmp/e2e-test-topology.yaml -y"
echo ""
echo "3. 检查部署结果:"
echo "   tiup cluster list"
echo ""
echo "4. 如果部署成功，继续执行 3.3 步骤启动集群"
echo "=========================================="

# 3.3 启动集群
echo "启动集群 $CLUSTER_NAME..."

# 先检查集群是否存在
if ! tiup cluster list 2>/dev/null | grep -q "^$CLUSTER_NAME"; then
    echo "✗ 错误: 集群 $CLUSTER_NAME 不存在，无法启动"
    echo "  请先执行 3.2 步骤部署集群"
    echo "  或者手动执行: cd /home/bearc/workspace/sourcecode/tiup && ./bin/tiup-cluster deploy $CLUSTER_NAME v7.5.1 /tmp/e2e-test-topology.yaml -y"
    echo ""
    echo "⚠ 警告: 集群不存在，请先部署集群"
    # 注意：不使用 exit，避免退出 shell 会话
else
    echo "✓ 集群存在，开始启动..."
    tiup cluster start "$CLUSTER_NAME"
    
    # 检查启动是否成功
    if [ $? -eq 0 ]; then
        echo "✓ 集群启动命令执行成功"
    else
        echo "✗ 集群启动失败，请检查错误信息"
        echo "⚠ 警告: 集群启动失败，请检查集群状态: tiup cluster display $CLUSTER_NAME"
        # 注意：不使用 exit，避免退出 shell 会话
    fi
fi

# 3.4 等待集群就绪（约 1-2 分钟）
echo "等待集群就绪..."
sleep 30

# 3.5 验证集群状态
echo "验证集群状态..."

# 先检查集群是否存在
if ! tiup cluster list 2>/dev/null | grep -q "^$CLUSTER_NAME"; then
    echo "✗ 错误: 集群 $CLUSTER_NAME 不存在"
    echo "  请先执行 3.2 步骤部署集群"
    echo "  或者手动执行: cd /home/bearc/workspace/sourcecode/tiup && ./bin/tiup-cluster deploy $CLUSTER_NAME v7.5.1 /tmp/e2e-test-topology.yaml -y"
    echo ""
    echo "⚠ 警告: 集群不存在，请先部署集群"
    # 注意：不使用 exit，避免退出 shell 会话
else
    echo "✓ 集群存在，显示集群状态..."
    tiup cluster display "$CLUSTER_NAME"
    
    # 检查 display 命令是否成功
    if [ $? -ne 0 ]; then
        echo "✗ 错误: 无法显示集群状态"
        echo "  可能的原因："
        echo "  1. 集群未启动: tiup cluster start $CLUSTER_NAME"
        echo "  2. 集群组件异常"
        echo ""
        echo "⚠ 警告: 集群状态显示失败，请检查集群状态"
        # 注意：不使用 exit，避免退出 shell 会话
    else
        echo "✓ 集群状态显示成功"
    fi
fi</pre>
                </div>
<h4>验证点</h4>

                <div class="checkpoint">
                    <div class="checkpoint-item">
                        <input type="checkbox" class="checkpoint-checkbox" data-id="prep-3-cp1" onchange="updateProgress()">
                        <div class="checkpoint-text">
                            <strong>集群部署成功（**如果集群不存在，请先执行 3.2 步骤部署集群**）</strong>
                            
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 检查集群是否存在
  if tiup cluster list 2>/dev/null | grep -q "^e2e-test-cluster"; then
    echo "✓ Cluster deployed"
  else
    echo "✗ Cluster not deployed"
    echo "  请执行以下命令部署集群："
    echo "  cd /home/bearc/workspace/sourcecode/tiup"
    echo "  ./bin/tiup-cluster deploy e2e-test-cluster v7.5.1 /tmp/e2e-test-topology.yaml -y"
  fi</pre>
                            </div>

                            <textarea class="remark-input" placeholder="添加备注..." data-id="prep-3-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                            <div class="remark-display" data-id="prep-3-cp1-remark-display" style="display: none;"></div>
                        </div>
                    </div>
                </div>

                <div class="checkpoint">
                    <div class="checkpoint-item">
                        <input type="checkbox" class="checkpoint-checkbox" data-id="prep-3-cp2" onchange="updateProgress()">
                        <div class="checkpoint-text">
                            <strong>集群启动成功（**如果集群未启动，请先执行 3.3 步骤启动集群**）</strong>
                            
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 先检查集群是否存在
  if ! tiup cluster list 2>/dev/null | grep -q "^e2e-test-cluster"; then
    echo "✗ Cluster not found, please deploy first"
    echo "  执行部署: cd /home/bearc/workspace/sourcecode/tiup && ./bin/tiup-cluster deploy e2e-test-cluster v7.5.1 /tmp/e2e-test-topology.yaml -y"
    # 注意：不使用 exit，避免退出 shell 会话
  else
    # 启动集群（如果未启动）
    tiup cluster start e2e-test-cluster
    
    # 等待并检查状态
    sleep 10
    if tiup cluster display e2e-test-cluster 2>/dev/null | grep -i "status.*up" > /dev/null; then
      echo "✓ Cluster started"
    else
      echo "✗ Cluster not started or components not ready"
      echo "  检查集群状态: tiup cluster display e2e-test-cluster"
    fi
  fi</pre>
                            </div>

                            <textarea class="remark-input" placeholder="添加备注..." data-id="prep-3-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                            <div class="remark-display" data-id="prep-3-cp2-remark-display" style="display: none;"></div>
                        </div>
                    </div>
                </div>

                <div class="checkpoint">
                    <div class="checkpoint-item">
                        <input type="checkbox" class="checkpoint-checkbox" data-id="prep-3-cp3" onchange="updateProgress()">
                        <div class="checkpoint-text">
                            <strong>所有组件状态为 "Up"（**如果集群不存在，请先部署和启动集群**）</strong>
                            
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 检查集群是否存在
  if ! tiup cluster list 2>/dev/null | grep -q "^e2e-test-cluster"; then
    echo "✗ Cluster not found, please deploy and start cluster first"
    echo "  执行部署: cd /home/bearc/workspace/sourcecode/tiup && ./bin/tiup-cluster deploy e2e-test-cluster v7.5.1 /tmp/e2e-test-topology.yaml -y"
    # 注意：不使用 exit，避免退出 shell 会话
  else
    # 检查组件状态
    if tiup cluster display e2e-test-cluster 2>/dev/null | grep -E "tidb|tikv|pd" | grep -v "Up" > /dev/null; then
      echo "✗ Some components not up"
      echo "  检查详细状态: tiup cluster display e2e-test-cluster"
    else
      echo "✓ All components up"
    fi
  fi</pre>
                            </div>

                            <textarea class="remark-input" placeholder="添加备注..." data-id="prep-3-cp3-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                            <div class="remark-display" data-id="prep-3-cp3-remark-display" style="display: none;"></div>
                        </div>
                    </div>
                </div>

                <div class="checkpoint">
                    <div class="checkpoint-item">
                        <input type="checkbox" class="checkpoint-checkbox" data-id="prep-3-cp4" onchange="updateProgress()">
                        <div class="checkpoint-text">
                            <strong>TiDB 端口 4000 可访问（**如果端口不可访问，请检查集群是否已启动**）</strong>
                            
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>if nc -z 127.0.0.1 4000 2>/dev/null; then
    echo "✓ TiDB port 4000 accessible"
    mysql -h 127.0.0.1 -P 4000 -u root -e "SELECT VERSION();" 2>&1 | head -1
  else
    echo "✗ TiDB port 4000 not accessible"
    echo "  请检查："
    echo "  1. 集群是否已启动: tiup cluster start e2e-test-cluster"
    echo "  2. TiDB 组件状态: tiup cluster display e2e-test-cluster"
  fi</pre>
                            </div>

                            <textarea class="remark-input" placeholder="添加备注..." data-id="prep-3-cp4-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                            <div class="remark-display" data-id="prep-3-cp4-remark-display" style="display: none;"></div>
                        </div>
                    </div>
                </div>

                <div class="checkpoint">
                    <div class="checkpoint-item">
                        <input type="checkbox" class="checkpoint-checkbox" data-id="prep-3-cp5" onchange="updateProgress()">
                        <div class="checkpoint-text">
                            <strong>PD 端口 2379 可访问（**如果端口不可访问，请检查集群是否已启动**）</strong>
                            
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>if nc -z 127.0.0.1 2379 2>/dev/null; then
    echo "✓ PD port 2379 accessible"
    curl -s http://127.0.0.1:2379/pd/api/v1/version 2>&1 | head -1
  else
    echo "✗ PD port 2379 not accessible"
    echo "  请检查："
    echo "  1. 集群是否已启动: tiup cluster start e2e-test-cluster"
    echo "  2. PD 组件状态: tiup cluster display e2e-test-cluster"
  fi</pre>
                            </div>

                            <textarea class="remark-input" placeholder="添加备注..." data-id="prep-3-cp5-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                            <div class="remark-display" data-id="prep-3-cp5-remark-display" style="display: none;"></div>
                        </div>
                    </div>
                </div>
</div></div>
<h2>测试阶段</h2>

        <div class="phase">
            <h3 class="collapsible" onclick="toggleSection(this)">Phase 1: Precheck-Only 模式测试</h3>
            <p style="margin: 10px 0; color: #666;"><strong>目标:</strong> </p>
            <div class="collapsed-content">

                <div class="test">
                    <div class="test-header">
                        <input type="checkbox" class="test-checkbox" data-id="phase-1-test-1.1" onchange="updateProgress()">
                        <h4>Test 1.1: 基本 Precheck-Only 测试</h4>
                    </div>

                    <div class="command-block">
                        <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                        <pre>cd /home/bearc/workspace/sourcecode/tiup

export TIDB_UPGRADE_PRECHECK_BIN=/home/bearc/workspace/sourcecode/tidb-upgrade-precheck/bin/upgrade-precheck
export TIDB_UPGRADE_PRECHECK_KB=/home/bearc/workspace/sourcecode/tidb-upgrade-precheck/knowledge

# 执行 precheck-only
./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck</pre>
                    </div>

                    <textarea class="remark-input" placeholder="添加测试备注..." data-id="phase-1-test-1.1-remark" onblur="saveRemark(this)"></textarea>
                    <div class="remark-display" data-id="phase-1-test-1.1-remark-display" style="display: none;"></div>
<h4>验证点</h4>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-1-test-1.1-cp1" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>命令执行成功</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>echo $?  # 应该返回 0</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-1-test-1.1-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-1-test-1.1-cp1-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-1-test-1.1-cp2" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>显示 "Running parameter precheck..."</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck 2>&1 | grep -i "running parameter precheck"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-1-test-1.1-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-1-test-1.1-cp2-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-1-test-1.1-cp3" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Precheck 执行完成</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck 2>&1 | grep -i "precheck\|report generated"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-1-test-1.1-cp3-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-1-test-1.1-cp3-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-1-test-1.1-cp4" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>报告显示在 stdout</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck 2>&1 | grep -E "Report|Summary|Findings" | head -5</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-1-test-1.1-cp4-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-1-test-1.1-cp4-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-1-test-1.1-cp5" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>命令退出，**不执行升级**</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 检查集群版本未改变
  tiup cluster display e2e-test-cluster | grep "Cluster version"
  # 应该仍然是 v7.5.1，不是 v8.5.4</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-1-test-1.1-cp5-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-1-test-1.1-cp5-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-1-test-1.1-cp6" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>退出码为 0（如果 precheck 成功）</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck
  echo "Exit code: $?"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-1-test-1.1-cp6-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-1-test-1.1-cp6-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-1-test-1.1-cp7" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>包含 "Running parameter precheck..."</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck 2>&1 | grep "Running parameter precheck"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-1-test-1.1-cp7-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-1-test-1.1-cp7-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-1-test-1.1-cp8" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>包含 "Executing: .../upgrade-precheck ..."</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck 2>&1 | grep "Executing:"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-1-test-1.1-cp8-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-1-test-1.1-cp8-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-1-test-1.1-cp9" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>包含报告内容或报告路径</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck 2>&1 | grep -E "Report generated|report.*\.(txt|html|md|json)"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-1-test-1.1-cp9-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-1-test-1.1-cp9-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-1-test-1.1-cp10" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>不包含升级相关操作</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck 2>&1 | grep -i "upgrading\|upgrade.*start\|component.*upgrade" && echo "✗ Found upgrade operations" || echo "✓ No upgrade operations"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-1-test-1.1-cp10-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-1-test-1.1-cp10-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
</div>

                <div class="test">
                    <div class="test-header">
                        <input type="checkbox" class="test-checkbox" data-id="phase-1-test-1.2" onchange="updateProgress()">
                        <h4>Test 1.2: Precheck-Only with Text Format</h4>
                    </div>

                    <div class="command-block">
                        <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                        <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 \
  --precheck \
  --precheck-output text</pre>
                    </div>

                    <textarea class="remark-input" placeholder="添加测试备注..." data-id="phase-1-test-1.2-remark" onblur="saveRemark(this)"></textarea>
                    <div class="remark-display" data-id="phase-1-test-1.2-remark-display" style="display: none;"></div>
<h4>验证点</h4>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-1-test-1.2-cp1" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>报告格式为 text</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck --precheck-output text 2>&1 | head -20</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-1-test-1.2-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-1-test-1.2-cp1-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-1-test-1.2-cp2" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>报告内容完整</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck --precheck-output text 2>&1 | grep -E "Source Version|Target Version|Check Results|Summary" | head -10</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-1-test-1.2-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-1-test-1.2-cp2-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-1-test-1.2-cp3" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>报告显示在 stdout</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck --precheck-output text 2>&1 | wc -l
  # 应该有多行输出</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-1-test-1.2-cp3-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-1-test-1.2-cp3-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
</div>

                <div class="test">
                    <div class="test-header">
                        <input type="checkbox" class="test-checkbox" data-id="phase-1-test-1.3" onchange="updateProgress()">
                        <h4>Test 1.3: Precheck-Only with HTML Format</h4>
                    </div>

                    <div class="command-block">
                        <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                        <pre># 运行命令并保存完整输出
./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck --precheck-output html 2>&1 | tee /tmp/precheck-output.log

# 检查输出中是否有 "Report generated successfully"
grep -i "report generated" /tmp/precheck-output.log

# 检查报告路径
grep -i "report\|\.html" /tmp/precheck-output.log

# 检查报告目录
find ~/.tiup -name "*.html" -type f 2>/dev/null | head -5

# 检查所有可能的报告位置
echo "=== Checking all possible report locations ==="
ls -lh ~/.tiup/upgrade_precheck/reports/*.html 2>/dev/null
ls -lh ~/.tiup/storage/cluster/upgrade_precheck/reports/*.html 2>/dev/null
find ~/.tiup -name "*precheck*" -type d 2>/dev/null</pre>
                    </div>

                    <textarea class="remark-input" placeholder="添加测试备注..." data-id="phase-1-test-1.3-remark" onblur="saveRemark(this)"></textarea>
                    <div class="remark-display" data-id="phase-1-test-1.3-remark-display" style="display: none;"></div>
<h4>验证点</h4>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-1-test-1.3-cp1" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>命令直接退出，无需用户交互（`--precheck` 模式下自动退出）</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck --precheck-output html
  echo "Exit code: $?"  # 应该返回 0</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-1-test-1.3-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-1-test-1.3-cp1-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-1-test-1.3-cp2" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>退出码为 0（precheck 完成即成功，无需用户确认）</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck --precheck-output html
  [ $? -eq 0 ] && echo "✓ Exit code is 0" || echo "✗ Exit code is not 0"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-1-test-1.3-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-1-test-1.3-cp2-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-1-test-1.3-cp3" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>报告格式为 HTML，且显示 "Precheck completed" 消息</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck --precheck-output html 2>&1 | grep -iE "html|report generated|precheck completed"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-1-test-1.3-cp3-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-1-test-1.3-cp3-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-1-test-1.3-cp4" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>报告文件生成在 `~/.tiup/upgrade_precheck/reports/`（注意：不是 `~/.tiup/storage/cluster/`）</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>ls -lh ~/.tiup/upgrade_precheck/reports/*.html</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-1-test-1.3-cp4-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-1-test-1.3-cp4-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-1-test-1.3-cp5" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>报告文件名格式为 `upgrade_precheck_report_*.html`</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>ls ~/.tiup/upgrade_precheck/reports/ | grep "upgrade_precheck_report_.*\.html"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-1-test-1.3-cp5-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-1-test-1.3-cp5-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-1-test-1.3-cp6" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>报告内容完整且格式正确</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>REPORT_FILE=$(ls -t ~/.tiup/upgrade_precheck/reports/*.html | head -1)
  echo "Report file: $REPORT_FILE"
  head -50 "$REPORT_FILE"
  # 检查 HTML 结构
  grep -E "<html|<head|<body|</html>" "$REPORT_FILE" | head -5</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-1-test-1.3-cp6-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-1-test-1.3-cp6-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-1-test-1.3-cp7" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>不包含升级相关操作（只运行 precheck，不执行升级）</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck --precheck-output html 2>&1 | grep -iE "upgrading component|restarting instance|executing.*upgrade|download.*tar\.gz" && echo "✗ Found upgrade operations" || echo "✓ No upgrade operations"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-1-test-1.3-cp7-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-1-test-1.3-cp7-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
</div>

                <div class="test">
                    <div class="test-header">
                        <input type="checkbox" class="test-checkbox" data-id="phase-1-test-1.4" onchange="updateProgress()">
                        <h4>Test 1.4: Precheck-Only with Markdown Format</h4>
                    </div>

                    <div class="command-block">
                        <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                        <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 \
  --precheck \
  --precheck-output markdown</pre>
                    </div>

                    <textarea class="remark-input" placeholder="添加测试备注..." data-id="phase-1-test-1.4-remark" onblur="saveRemark(this)"></textarea>
                    <div class="remark-display" data-id="phase-1-test-1.4-remark-display" style="display: none;"></div>
<h4>验证点</h4>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-1-test-1.4-cp1" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>报告格式为 markdown</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck --precheck-output markdown 2>&1 | grep -i "markdown\|report generated"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-1-test-1.4-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-1-test-1.4-cp1-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-1-test-1.4-cp2" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>报告文件生成在 `~/.tiup/upgrade_precheck/reports/`</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>ls -lh ~/.tiup/upgrade_precheck/reports/*.md</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-1-test-1.4-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-1-test-1.4-cp2-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-1-test-1.4-cp3" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Markdown 格式正确</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>REPORT_FILE=$(ls -t ~/.tiup/upgrade_precheck/reports/*.md | head -1)
  echo "Report file: $REPORT_FILE"
  head -30 "$REPORT_FILE"
  # 检查 Markdown 语法
  grep -E "^#|^##|^\*|^-" "$REPORT_FILE" | head -10</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-1-test-1.4-cp3-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-1-test-1.4-cp3-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
</div>

                <div class="test">
                    <div class="test-header">
                        <input type="checkbox" class="test-checkbox" data-id="phase-1-test-1.5" onchange="updateProgress()">
                        <h4>Test 1.5: Precheck-Only with Custom Output File</h4>
                    </div>

                    <div class="command-block">
                        <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                        <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 \
  --precheck \
  --precheck-output html \
  --precheck-output-file /tmp/precheck-report.html</pre>
                    </div>

                    <textarea class="remark-input" placeholder="添加测试备注..." data-id="phase-1-test-1.5-remark" onblur="saveRemark(this)"></textarea>
                    <div class="remark-display" data-id="phase-1-test-1.5-remark-display" style="display: none;"></div>
<h4>验证点</h4>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-1-test-1.5-cp1" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>报告保存到指定文件</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck --precheck-output html --precheck-output-file /tmp/precheck-report.html
  ls -lh /tmp/precheck-report.html</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-1-test-1.5-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-1-test-1.5-cp1-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-1-test-1.5-cp2" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>文件内容完整</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>wc -l /tmp/precheck-report.html
  head -50 /tmp/precheck-report.html</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-1-test-1.5-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-1-test-1.5-cp2-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-1-test-1.5-cp3" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>文件格式正确</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>file /tmp/precheck-report.html
  grep -E "<html|<head|<body" /tmp/precheck-report.html | head -3</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-1-test-1.5-cp3-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-1-test-1.5-cp3-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
</div>
</div></div>

        <div class="phase">
            <h3 class="collapsible" onclick="toggleSection(this)">Phase 2: 完整升级流程测试（默认行为）</h3>
            <p style="margin: 10px 0; color: #666;"><strong>目标:</strong> </p>
            <div class="collapsed-content">

                <div class="test">
                    <div class="test-header">
                        <input type="checkbox" class="test-checkbox" data-id="phase-2-test-1.5" onchange="updateProgress()">
                        <h4>Test 1.5: Precheck-Only with Custom Output File</h4>
                    </div>

                    <div class="command-block">
                        <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                        <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 \
  --precheck \
  --precheck-output html \
  --precheck-output-file /tmp/precheck-report.html</pre>
                    </div>

                    <textarea class="remark-input" placeholder="添加测试备注..." data-id="phase-2-test-1.5-remark" onblur="saveRemark(this)"></textarea>
                    <div class="remark-display" data-id="phase-2-test-1.5-remark-display" style="display: none;"></div>
<h4>验证点</h4>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-2-test-1.5-cp1" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>报告保存到指定文件</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck --precheck-output html --precheck-output-file /tmp/precheck-report.html
  ls -lh /tmp/precheck-report.html</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-2-test-1.5-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-2-test-1.5-cp1-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-2-test-1.5-cp2" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>文件内容完整</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>wc -l /tmp/precheck-report.html
  head -50 /tmp/precheck-report.html</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-2-test-1.5-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-2-test-1.5-cp2-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-2-test-1.5-cp3" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>文件格式正确</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>file /tmp/precheck-report.html
  grep -E "<html|<head|<body" /tmp/precheck-report.html | head -3</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-2-test-1.5-cp3-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-2-test-1.5-cp3-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
</div>

                <div class="test">
                    <div class="test-header">
                        <input type="checkbox" class="test-checkbox" data-id="phase-2-test-2.1" onchange="updateProgress()">
                        <h4>Test 2.1: 默认升级流程（自动 Precheck）</h4>
                    </div>

                    <div class="command-block">
                        <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                        <pre>tiup cluster display e2e-test-cluster | grep "Cluster version"
   # 应该显示 v8.5.4</pre>
                    </div>

                    <textarea class="remark-input" placeholder="添加测试备注..." data-id="phase-2-test-2.1-remark" onblur="saveRemark(this)"></textarea>
                    <div class="remark-display" data-id="phase-2-test-2.1-remark-display" style="display: none;"></div>
<h4>验证点</h4>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-2-test-2.1-cp1" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>自动运行 precheck（不显示 --precheck 标志）</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 2>&1 | grep -i "running parameter precheck"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-2-test-2.1-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-2-test-2.1-cp1-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-2-test-2.1-cp2" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>显示 precheck 报告</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 2>&1 | grep -E "Report|Summary|Findings" | head -5</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-2-test-2.1-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-2-test-2.1-cp2-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-2-test-2.1-cp3" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>询问用户确认</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 注意：这个测试需要交互，可以查看输出中是否包含确认提示
  echo "n" | ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 2>&1 | grep -i "confirm\|continue\|backup"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-2-test-2.1-cp3-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-2-test-2.1-cp3-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-2-test-2.1-cp4" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>如果确认，执行升级</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 注意：这会实际执行升级，请谨慎使用
  # echo "y" | ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4
  # 升级后检查版本
  # tiup cluster display e2e-test-cluster | grep "Cluster version"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-2-test-2.1-cp4-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-2-test-2.1-cp4-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-2-test-2.1-cp5" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>如果取消，不执行升级</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>echo "n" | ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 2>&1 | tail -5
  # 检查集群版本未改变
  tiup cluster display e2e-test-cluster | grep "Cluster version"
  # 应该仍然是 v7.5.1</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-2-test-2.1-cp5-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-2-test-2.1-cp5-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
</div>

                <div class="test">
                    <div class="test-header">
                        <input type="checkbox" class="test-checkbox" data-id="phase-2-test-2.2" onchange="updateProgress()">
                        <h4>Test 2.2: 默认升级流程 with HTML Report</h4>
                    </div>

                    <div class="command-block">
                        <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                        <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 \
  --precheck-output html</pre>
                    </div>

                    <textarea class="remark-input" placeholder="添加测试备注..." data-id="phase-2-test-2.2-remark" onblur="saveRemark(this)"></textarea>
                    <div class="remark-display" data-id="phase-2-test-2.2-remark-display" style="display: none;"></div>
<h4>验证点</h4>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-2-test-2.2-cp1" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>自动运行 precheck</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck-output html 2>&1 | grep -i "running parameter precheck"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-2-test-2.2-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-2-test-2.2-cp1-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-2-test-2.2-cp2" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>HTML 报告生成</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>ls -lh ~/.tiup/storage/cluster/upgrade_precheck/reports/*.html</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-2-test-2.2-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-2-test-2.2-cp2-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-2-test-2.2-cp3" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>报告路径显示</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck-output html 2>&1 | grep -E "Report generated|report.*\.html"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-2-test-2.2-cp3-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-2-test-2.2-cp3-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-2-test-2.2-cp4" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>询问用户确认</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>echo "n" | ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck-output html 2>&1 | grep -i "confirm\|continue"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-2-test-2.2-cp4-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-2-test-2.2-cp4-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
</div>

                <div class="test">
                    <div class="test-header">
                        <input type="checkbox" class="test-checkbox" data-id="phase-2-test-2.3" onchange="updateProgress()">
                        <h4>Test 2.3: 默认升级流程 with Skip Confirm</h4>
                    </div>

                    <div class="command-block">
                        <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                        <pre># 注意：这会直接执行升级，不询问确认
./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 -y</pre>
                    </div>

                    <textarea class="remark-input" placeholder="添加测试备注..." data-id="phase-2-test-2.3-remark" onblur="saveRemark(this)"></textarea>
                    <div class="remark-display" data-id="phase-2-test-2.3-remark-display" style="display: none;"></div>
<h4>验证点</h4>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-2-test-2.3-cp1" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>自动运行 precheck</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 -y 2>&1 | grep -i "running parameter precheck"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-2-test-2.3-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-2-test-2.3-cp1-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-2-test-2.3-cp2" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>显示报告</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 -y 2>&1 | grep -E "Report|Summary" | head -5</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-2-test-2.3-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-2-test-2.3-cp2-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-2-test-2.3-cp3" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>跳过确认，直接执行升级</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 注意：这会实际执行升级
  # ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 -y 2>&1 | grep -i "confirm" && echo "✗ Still asking for confirmation" || echo "✓ Skipped confirmation"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-2-test-2.3-cp3-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-2-test-2.3-cp3-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-2-test-2.3-cp4" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>升级完成</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 升级后检查
  tiup cluster display e2e-test-cluster | grep "Cluster version"
  # 应该显示 v8.5.4</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-2-test-2.3-cp4-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-2-test-2.3-cp4-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
</div>
</div></div>

        <div class="phase">
            <h3 class="collapsible" onclick="toggleSection(this)">Phase 3: 凭证和认证测试</h3>
            <p style="margin: 10px 0; color: #666;"><strong>目标:</strong> </p>
            <div class="collapsed-content">

                <div class="test">
                    <div class="test-header">
                        <input type="checkbox" class="test-checkbox" data-id="phase-3-test-2.3" onchange="updateProgress()">
                        <h4>Test 2.3: 默认升级流程 with Skip Confirm</h4>
                    </div>

                    <div class="command-block">
                        <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                        <pre># 注意：这会直接执行升级，不询问确认
./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 -y</pre>
                    </div>

                    <textarea class="remark-input" placeholder="添加测试备注..." data-id="phase-3-test-2.3-remark" onblur="saveRemark(this)"></textarea>
                    <div class="remark-display" data-id="phase-3-test-2.3-remark-display" style="display: none;"></div>
<h4>验证点</h4>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-3-test-2.3-cp1" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>自动运行 precheck</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 -y 2>&1 | grep -i "running parameter precheck"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-3-test-2.3-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-3-test-2.3-cp1-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-3-test-2.3-cp2" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>显示报告</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 -y 2>&1 | grep -E "Report|Summary" | head -5</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-3-test-2.3-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-3-test-2.3-cp2-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-3-test-2.3-cp3" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>跳过确认，直接执行升级</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 注意：这会实际执行升级
  # ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 -y 2>&1 | grep -i "confirm" && echo "✗ Still asking for confirmation" || echo "✓ Skipped confirmation"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-3-test-2.3-cp3-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-3-test-2.3-cp3-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-3-test-2.3-cp4" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>升级完成</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 升级后检查
  tiup cluster display e2e-test-cluster | grep "Cluster version"
  # 应该显示 v8.5.4</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-3-test-2.3-cp4-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-3-test-2.3-cp4-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
</div>

                <div class="test">
                    <div class="test-header">
                        <input type="checkbox" class="test-checkbox" data-id="phase-3-test-3.1" onchange="updateProgress()">
                        <h4>Test 3.1: 默认用户（root）</h4>
                    </div>

                    <div class="command-block">
                        <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                        <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 \
  --precheck \
  --precheck-tidb-user root</pre>
                    </div>

                    <textarea class="remark-input" placeholder="添加测试备注..." data-id="phase-3-test-3.1-remark" onblur="saveRemark(this)"></textarea>
                    <div class="remark-display" data-id="phase-3-test-3.1-remark-display" style="display: none;"></div>
<h4>验证点</h4>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-3-test-3.1-cp1" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>使用 root 用户连接</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck --precheck-tidb-user root 2>&1 | grep -i "tidb-user\|connecting"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-3-test-3.1-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-3-test-3.1-cp1-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-3-test-3.1-cp2" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>连接成功</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck --precheck-tidb-user root 2>&1 | grep -i "error\|failed\|connection" && echo "✗ Connection failed" || echo "✓ Connection successful"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-3-test-3.1-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-3-test-3.1-cp2-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-3-test-3.1-cp3" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>配置收集成功</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck --precheck-tidb-user root 2>&1 | grep -i "collecting\|configuration\|report generated" && echo "✓ Config collection successful" || echo "✗ Config collection failed"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-3-test-3.1-cp3-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-3-test-3.1-cp3-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
</div>

                <div class="test">
                    <div class="test-header">
                        <input type="checkbox" class="test-checkbox" data-id="phase-3-test-3.2" onchange="updateProgress()">
                        <h4>Test 3.2: 自定义用户</h4>
                    </div>

                    <div class="command-block">
                        <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                        <pre># 如果集群中有其他用户
./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 \
  --precheck \
  --precheck-tidb-user admin</pre>
                    </div>

                    <textarea class="remark-input" placeholder="添加测试备注..." data-id="phase-3-test-3.2-remark" onblur="saveRemark(this)"></textarea>
                    <div class="remark-display" data-id="phase-3-test-3.2-remark-display" style="display: none;"></div>
<h4>验证点</h4>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-3-test-3.2-cp1" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>使用指定用户连接</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck --precheck-tidb-user admin 2>&1 | grep -i "tidb-user.*admin\|connecting.*admin"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-3-test-3.2-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-3-test-3.2-cp1-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-3-test-3.2-cp2" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>连接成功或显示适当错误</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck --precheck-tidb-user admin 2>&1 | grep -E "error|failed|success|connection" | head -3</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-3-test-3.2-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-3-test-3.2-cp2-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
</div>

                <div class="test">
                    <div class="test-header">
                        <input type="checkbox" class="test-checkbox" data-id="phase-3-test-3.3" onchange="updateProgress()">
                        <h4>Test 3.3: 密码提示</h4>
                    </div>

                    <div class="command-block">
                        <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                        <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 \
  --precheck \
  --precheck-tidb-password-prompt</pre>
                    </div>

                    <textarea class="remark-input" placeholder="添加测试备注..." data-id="phase-3-test-3.3-remark" onblur="saveRemark(this)"></textarea>
                    <div class="remark-display" data-id="phase-3-test-3.3-remark-display" style="display: none;"></div>
<h4>验证点</h4>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-3-test-3.3-cp1" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>提示输入密码</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 注意：这个测试需要交互，可以检查帮助信息或代码
  ./bin/tiup-cluster upgrade --help | grep -i "password-prompt"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-3-test-3.3-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-3-test-3.3-cp1-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-3-test-3.3-cp2" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>接受密码输入</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 手动测试：执行命令并输入密码
  # ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck --precheck-tidb-password-prompt</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-3-test-3.3-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-3-test-3.3-cp2-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-3-test-3.3-cp3" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>使用密码连接</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 手动测试后检查连接是否成功
  # 查看输出中是否有连接错误</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-3-test-3.3-cp3-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-3-test-3.3-cp3-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
</div>

                <div class="test">
                    <div class="test-header">
                        <input type="checkbox" class="test-checkbox" data-id="phase-3-test-3.4" onchange="updateProgress()">
                        <h4>Test 3.4: 密码文件</h4>
                    </div>

                    <div class="command-block">
                        <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                        <pre>echo "your-password" > /tmp/tidb-password.txt
chmod 600 /tmp/tidb-password.txt

./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 \
  --precheck \
  --precheck-tidb-password-file /tmp/tidb-password.txt

# 清理
rm /tmp/tidb-password.txt</pre>
                    </div>

                    <textarea class="remark-input" placeholder="添加测试备注..." data-id="phase-3-test-3.4-remark" onblur="saveRemark(this)"></textarea>
                    <div class="remark-display" data-id="phase-3-test-3.4-remark-display" style="display: none;"></div>
<h4>验证点</h4>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-3-test-3.4-cp1" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>从文件读取密码</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>echo "test-password" > /tmp/tidb-password.txt
  chmod 600 /tmp/tidb-password.txt
  ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck --precheck-tidb-password-file /tmp/tidb-password.txt 2>&1 | grep -i "password.*file\|reading.*password"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-3-test-3.4-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-3-test-3.4-cp1-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-3-test-3.4-cp2" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>使用密码连接</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck --precheck-tidb-password-file /tmp/tidb-password.txt 2>&1 | grep -E "error|failed|success|connection" | head -3</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-3-test-3.4-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-3-test-3.4-cp2-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-3-test-3.4-cp3" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>文件权限检查（如果实现）</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>chmod 644 /tmp/tidb-password.txt
  ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck --precheck-tidb-password-file /tmp/tidb-password.txt 2>&1 | grep -i "permission\|security\|readable" && echo "✓ Permission check exists" || echo "⚠ Permission check not implemented"
  rm /tmp/tidb-password.txt</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-3-test-3.4-cp3-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-3-test-3.4-cp3-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
</div>
</div></div>

        <div class="phase">
            <h3 class="collapsible" onclick="toggleSection(this)">Phase 4: 高风险参数配置测试</h3>
            <p style="margin: 10px 0; color: #666;"><strong>目标:</strong> </p>
            <div class="collapsed-content">

                <div class="test">
                    <div class="test-header">
                        <input type="checkbox" class="test-checkbox" data-id="phase-4-test-3.4" onchange="updateProgress()">
                        <h4>Test 3.4: 密码文件</h4>
                    </div>

                    <div class="command-block">
                        <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                        <pre>echo "your-password" > /tmp/tidb-password.txt
chmod 600 /tmp/tidb-password.txt

./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 \
  --precheck \
  --precheck-tidb-password-file /tmp/tidb-password.txt

# 清理
rm /tmp/tidb-password.txt</pre>
                    </div>

                    <textarea class="remark-input" placeholder="添加测试备注..." data-id="phase-4-test-3.4-remark" onblur="saveRemark(this)"></textarea>
                    <div class="remark-display" data-id="phase-4-test-3.4-remark-display" style="display: none;"></div>
<h4>验证点</h4>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-4-test-3.4-cp1" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>从文件读取密码</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>echo "test-password" > /tmp/tidb-password.txt
  chmod 600 /tmp/tidb-password.txt
  ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck --precheck-tidb-password-file /tmp/tidb-password.txt 2>&1 | grep -i "password.*file\|reading.*password"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-4-test-3.4-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-4-test-3.4-cp1-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-4-test-3.4-cp2" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>使用密码连接</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck --precheck-tidb-password-file /tmp/tidb-password.txt 2>&1 | grep -E "error|failed|success|connection" | head -3</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-4-test-3.4-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-4-test-3.4-cp2-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-4-test-3.4-cp3" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>文件权限检查（如果实现）</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>chmod 644 /tmp/tidb-password.txt
  ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck --precheck-tidb-password-file /tmp/tidb-password.txt 2>&1 | grep -i "permission\|security\|readable" && echo "✓ Permission check exists" || echo "⚠ Permission check not implemented"
  rm /tmp/tidb-password.txt</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-4-test-3.4-cp3-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-4-test-3.4-cp3-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
</div>

                <div class="test">
                    <div class="test-header">
                        <input type="checkbox" class="test-checkbox" data-id="phase-4-test-4.1" onchange="updateProgress()">
                        <h4>Test 4.1: 创建高风险参数配置</h4>
                    </div>

                    <div class="command-block">
                        <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                        <pre>cat > /tmp/high_risk_params.json << 'EOF'
{
  "tidb": {
    "config": {},
    "system_variables": {
      "tidb_enable_async_commit": {
        "severity": "error",
        "description": "Async commit may cause data inconsistency",
        "from_version": "v7.0.0",
        "to_version": "",
        "check_modified": true,
        "allowed_values": []
      }
    }
  },
  "pd": {
    "config": {}
  },
  "tikv": {
    "config": {}
  },
  "tiflash": {
    "config": {}
  }
}
EOF</pre>
                    </div>

                    <textarea class="remark-input" placeholder="添加测试备注..." data-id="phase-4-test-4.1-remark" onblur="saveRemark(this)"></textarea>
                    <div class="remark-display" data-id="phase-4-test-4.1-remark-display" style="display: none;"></div>
</div>

                <div class="test">
                    <div class="test-header">
                        <input type="checkbox" class="test-checkbox" data-id="phase-4-test-4.2" onchange="updateProgress()">
                        <h4>Test 4.2: Precheck with High-Risk Config</h4>
                    </div>

                    <div class="command-block">
                        <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                        <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 \
  --precheck \
  --precheck-high-risk-params-config /tmp/high_risk_params.json</pre>
                    </div>

                    <textarea class="remark-input" placeholder="添加测试备注..." data-id="phase-4-test-4.2-remark" onblur="saveRemark(this)"></textarea>
                    <div class="remark-display" data-id="phase-4-test-4.2-remark-display" style="display: none;"></div>
<h4>验证点</h4>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-4-test-4.2-cp1" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>配置文件正确加载</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck --precheck-high-risk-params-config /tmp/high_risk_params.json 2>&1 | grep -i "loading.*high.*risk\|config.*loaded"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-4-test-4.2-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-4-test-4.2-cp1-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-4-test-4.2-cp2" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>高风险参数规则执行</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck --precheck-high-risk-params-config /tmp/high_risk_params.json 2>&1 | grep -i "high.*risk\|checking.*parameter"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-4-test-4.2-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-4-test-4.2-cp2-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-4-test-4.2-cp3" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>检查结果包含在报告中</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck --precheck-high-risk-params-config /tmp/high_risk_params.json 2>&1 | grep -i "tidb_enable_async_commit\|high.*risk.*finding"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-4-test-4.2-cp3-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-4-test-4.2-cp3-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-4-test-4.2-cp4" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>如果发现问题，报告显示相应警告/错误</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck --precheck-high-risk-params-config /tmp/high_risk_params.json 2>&1 | grep -E "error|warning|severity" | head -5</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-4-test-4.2-cp4-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-4-test-4.2-cp4-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
</div>

                <div class="test">
                    <div class="test-header">
                        <input type="checkbox" class="test-checkbox" data-id="phase-4-test-4.3" onchange="updateProgress()">
                        <h4>Test 4.3: Default High-Risk Config Location</h4>
                    </div>

                    <div class="command-block">
                        <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                        <pre># 复制到默认位置
cp /tmp/high_risk_params.json ~/.tiup/high_risk_params.json

# 不指定 --precheck-high-risk-params-config
./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck</pre>
                    </div>

                    <textarea class="remark-input" placeholder="添加测试备注..." data-id="phase-4-test-4.3-remark" onblur="saveRemark(this)"></textarea>
                    <div class="remark-display" data-id="phase-4-test-4.3-remark-display" style="display: none;"></div>
<h4>验证点</h4>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-4-test-4.3-cp1" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>自动从默认位置加载配置</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck 2>&1 | grep -i "loading.*high.*risk\|~/.tiup/high_risk_params.json"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-4-test-4.3-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-4-test-4.3-cp1-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-4-test-4.3-cp2" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>高风险参数规则执行</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck 2>&1 | grep -i "high.*risk\|checking.*parameter"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-4-test-4.3-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-4-test-4.3-cp2-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
</div>
</div></div>

        <div class="phase">
            <h3 class="collapsible" onclick="toggleSection(this)">Phase 5: 错误处理和边界情况</h3>
            <p style="margin: 10px 0; color: #666;"><strong>目标:</strong> </p>
            <div class="collapsed-content">

                <div class="test">
                    <div class="test-header">
                        <input type="checkbox" class="test-checkbox" data-id="phase-5-test-4.3" onchange="updateProgress()">
                        <h4>Test 4.3: Default High-Risk Config Location</h4>
                    </div>

                    <div class="command-block">
                        <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                        <pre># 复制到默认位置
cp /tmp/high_risk_params.json ~/.tiup/high_risk_params.json

# 不指定 --precheck-high-risk-params-config
./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck</pre>
                    </div>

                    <textarea class="remark-input" placeholder="添加测试备注..." data-id="phase-5-test-4.3-remark" onblur="saveRemark(this)"></textarea>
                    <div class="remark-display" data-id="phase-5-test-4.3-remark-display" style="display: none;"></div>
<h4>验证点</h4>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-5-test-4.3-cp1" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>自动从默认位置加载配置</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck 2>&1 | grep -i "loading.*high.*risk\|~/.tiup/high_risk_params.json"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-5-test-4.3-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-5-test-4.3-cp1-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-5-test-4.3-cp2" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>高风险参数规则执行</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck 2>&1 | grep -i "high.*risk\|checking.*parameter"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-5-test-4.3-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-5-test-4.3-cp2-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
</div>

                <div class="test">
                    <div class="test-header">
                        <input type="checkbox" class="test-checkbox" data-id="phase-5-test-5.1" onchange="updateProgress()">
                        <h4>Test 5.1: 跳过 Precheck</h4>
                    </div>

                    <div class="command-block">
                        <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                        <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 \
  --without-precheck</pre>
                    </div>

                    <textarea class="remark-input" placeholder="添加测试备注..." data-id="phase-5-test-5.1-remark" onblur="saveRemark(this)"></textarea>
                    <div class="remark-display" data-id="phase-5-test-5.1-remark-display" style="display: none;"></div>
<h4>验证点</h4>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-5-test-5.1-cp1" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Precheck 被跳过</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --without-precheck 2>&1 | grep -i "precheck" && echo "✗ Precheck not skipped" || echo "✓ Precheck skipped"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-5-test-5.1-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-5-test-5.1-cp1-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-5-test-5.1-cp2" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>直接执行升级</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 注意：这会实际执行升级
  # ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --without-precheck 2>&1 | grep -i "upgrading\|upgrade.*start"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-5-test-5.1-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-5-test-5.1-cp2-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-5-test-5.1-cp3" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>不显示 precheck 相关信息</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --without-precheck 2>&1 | grep -i "running parameter precheck\|precheck.*report" && echo "✗ Precheck info shown" || echo "✓ No precheck info"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-5-test-5.1-cp3-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-5-test-5.1-cp3-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
</div>

                <div class="test">
                    <div class="test-header">
                        <input type="checkbox" class="test-checkbox" data-id="phase-5-test-5.2" onchange="updateProgress()">
                        <h4>Test 5.2: Precheck 失败但继续升级</h4>
                    </div>

                    <div class="command-block">
                        <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                        <pre># 模拟 precheck 失败（例如：临时移除知识库）
mv "$TIDB_UPGRADE_PRECHECK_KB" "${TIDB_UPGRADE_PRECHECK_KB}.bak"

./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4

# 恢复知识库
mv "${TIDB_UPGRADE_PRECHECK_KB}.bak" "$TIDB_UPGRADE_PRECHECK_KB"</pre>
                    </div>

                    <textarea class="remark-input" placeholder="添加测试备注..." data-id="phase-5-test-5.2-remark" onblur="saveRemark(this)"></textarea>
                    <div class="remark-display" data-id="phase-5-test-5.2-remark-display" style="display: none;"></div>
<h4>验证点</h4>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-5-test-5.2-cp1" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Precheck 失败显示警告</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>mv "$TIDB_UPGRADE_PRECHECK_KB" "${TIDB_UPGRADE_PRECHECK_KB}.bak"
  ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 2>&1 | grep -i "precheck.*fail\|warning.*precheck"
  mv "${TIDB_UPGRADE_PRECHECK_KB}.bak" "$TIDB_UPGRADE_PRECHECK_KB"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-5-test-5.2-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-5-test-5.2-cp1-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-5-test-5.2-cp2" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>仍然询问用户确认</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>mv "$TIDB_UPGRADE_PRECHECK_KB" "${TIDB_UPGRADE_PRECHECK_KB}.bak"
  echo "n" | ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 2>&1 | grep -i "confirm\|continue"
  mv "${TIDB_UPGRADE_PRECHECK_KB}.bak" "$TIDB_UPGRADE_PRECHECK_KB"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-5-test-5.2-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-5-test-5.2-cp2-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-5-test-5.2-cp3" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>用户可以选择继续升级</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 手动测试：即使 precheck 失败，用户仍可以确认继续
  # mv "$TIDB_UPGRADE_PRECHECK_KB" "${TIDB_UPGRADE_PRECHECK_KB}.bak"
  # echo "y" | ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4
  # mv "${TIDB_UPGRADE_PRECHECK_KB}.bak" "$TIDB_UPGRADE_PRECHECK_KB"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-5-test-5.2-cp3-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-5-test-5.2-cp3-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-5-test-5.2-cp4" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>升级可以正常执行</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 手动测试后验证升级是否完成
  # tiup cluster display e2e-test-cluster | grep "Cluster version"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-5-test-5.2-cp4-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-5-test-5.2-cp4-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
</div>

                <div class="test">
                    <div class="test-header">
                        <input type="checkbox" class="test-checkbox" data-id="phase-5-test-5.3" onchange="updateProgress()">
                        <h4>Test 5.3: 无效集群名称</h4>
                    </div>

                    <div class="command-block">
                        <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                        <pre>./bin/tiup-cluster upgrade non-existent-cluster v8.5.4 --precheck</pre>
                    </div>

                    <textarea class="remark-input" placeholder="添加测试备注..." data-id="phase-5-test-5.3-remark" onblur="saveRemark(this)"></textarea>
                    <div class="remark-display" data-id="phase-5-test-5.3-remark-display" style="display: none;"></div>
<h4>验证点</h4>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-5-test-5.3-cp1" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>显示清晰的错误信息</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade non-existent-cluster v8.5.4 --precheck 2>&1 | grep -i "error\|not found\|cluster.*exist"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-5-test-5.3-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-5-test-5.3-cp1-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-5-test-5.3-cp2" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>不执行 precheck</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade non-existent-cluster v8.5.4 --precheck 2>&1 | grep -i "running parameter precheck" && echo "✗ Precheck executed" || echo "✓ Precheck not executed"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-5-test-5.3-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-5-test-5.3-cp2-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-5-test-5.3-cp3" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>退出码非零</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade non-existent-cluster v8.5.4 --precheck
  echo "Exit code: $?"
  # 应该返回非零值</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-5-test-5.3-cp3-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-5-test-5.3-cp3-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
</div>

                <div class="test">
                    <div class="test-header">
                        <input type="checkbox" class="test-checkbox" data-id="phase-5-test-5.4" onchange="updateProgress()">
                        <h4>Test 5.4: 无效目标版本</h4>
                    </div>

                    <div class="command-block">
                        <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                        <pre>./bin/tiup-cluster upgrade e2e-test-cluster invalid-version --precheck</pre>
                    </div>

                    <textarea class="remark-input" placeholder="添加测试备注..." data-id="phase-5-test-5.4-remark" onblur="saveRemark(this)"></textarea>
                    <div class="remark-display" data-id="phase-5-test-5.4-remark-display" style="display: none;"></div>
<h4>验证点</h4>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-5-test-5.4-cp1" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>显示版本错误信息</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster invalid-version --precheck 2>&1 | grep -i "version.*invalid\|version.*not found\|invalid.*version"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-5-test-5.4-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-5-test-5.4-cp1-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-5-test-5.4-cp2" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>或显示知识库缺失错误</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster invalid-version --precheck 2>&1 | grep -i "knowledge.*base.*not found\|knowledge.*base.*missing"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-5-test-5.4-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-5-test-5.4-cp2-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-5-test-5.4-cp3" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>不执行 precheck</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster invalid-version --precheck 2>&1 | grep -i "running parameter precheck" && echo "✗ Precheck executed" || echo "✓ Precheck not executed"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-5-test-5.4-cp3-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-5-test-5.4-cp3-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
</div>

                <div class="test">
                    <div class="test-header">
                        <input type="checkbox" class="test-checkbox" data-id="phase-5-test-5.5" onchange="updateProgress()">
                        <h4>Test 5.5: 缺少环境变量（二进制路径）</h4>
                    </div>

                    <div class="command-block">
                        <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                        <pre>unset TIDB_UPGRADE_PRECHECK_BIN
./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck</pre>
                    </div>

                    <textarea class="remark-input" placeholder="添加测试备注..." data-id="phase-5-test-5.5-remark" onblur="saveRemark(this)"></textarea>
                    <div class="remark-display" data-id="phase-5-test-5.5-remark-display" style="display: none;"></div>
<h4>验证点</h4>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-5-test-5.5-cp1" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>TiUP 尝试从其他位置查找二进制</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>unset TIDB_UPGRADE_PRECHECK_BIN
  ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck 2>&1 | grep -i "trying\|looking.*for\|searching"
  export TIDB_UPGRADE_PRECHECK_BIN=/home/bearc/workspace/sourcecode/tidb-upgrade-precheck/bin/upgrade-precheck</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-5-test-5.5-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-5-test-5.5-cp1-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-5-test-5.5-cp2" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>或显示清晰的错误信息</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>unset TIDB_UPGRADE_PRECHECK_BIN
  ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck 2>&1 | grep -i "error.*binary\|not found\|cannot.*find"
  export TIDB_UPGRADE_PRECHECK_BIN=/home/bearc/workspace/sourcecode/tidb-upgrade-precheck/bin/upgrade-precheck</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-5-test-5.5-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-5-test-5.5-cp2-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-5-test-5.5-cp3" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>错误信息包含解决建议</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>unset TIDB_UPGRADE_PRECHECK_BIN
  ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck 2>&1 | grep -i "set.*TIDB_UPGRADE_PRECHECK_BIN\|environment.*variable\|solution"
  export TIDB_UPGRADE_PRECHECK_BIN=/home/bearc/workspace/sourcecode/tidb-upgrade-precheck/bin/upgrade-precheck</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-5-test-5.5-cp3-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-5-test-5.5-cp3-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
</div>

                <div class="test">
                    <div class="test-header">
                        <input type="checkbox" class="test-checkbox" data-id="phase-5-test-5.6" onchange="updateProgress()">
                        <h4>Test 5.6: 缺少环境变量（知识库路径）</h4>
                    </div>

                    <div class="command-block">
                        <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                        <pre>unset TIDB_UPGRADE_PRECHECK_KB
./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck</pre>
                    </div>

                    <textarea class="remark-input" placeholder="添加测试备注..." data-id="phase-5-test-5.6-remark" onblur="saveRemark(this)"></textarea>
                    <div class="remark-display" data-id="phase-5-test-5.6-remark-display" style="display: none;"></div>
<h4>验证点</h4>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-5-test-5.6-cp1" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>TiUP 尝试从其他位置查找知识库</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>unset TIDB_UPGRADE_PRECHECK_KB
  ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck 2>&1 | grep -i "trying\|looking.*for\|searching.*knowledge"
  export TIDB_UPGRADE_PRECHECK_KB=/home/bearc/workspace/sourcecode/tidb-upgrade-precheck/knowledge</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-5-test-5.6-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-5-test-5.6-cp1-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-5-test-5.6-cp2" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>或显示清晰的错误信息</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>unset TIDB_UPGRADE_PRECHECK_KB
  ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck 2>&1 | grep -i "error.*knowledge\|knowledge.*not found\|cannot.*find.*knowledge"
  export TIDB_UPGRADE_PRECHECK_KB=/home/bearc/workspace/sourcecode/tidb-upgrade-precheck/knowledge</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-5-test-5.6-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-5-test-5.6-cp2-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-5-test-5.6-cp3" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>错误信息包含解决建议</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>unset TIDB_UPGRADE_PRECHECK_KB
  ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck 2>&1 | grep -i "set.*TIDB_UPGRADE_PRECHECK_KB\|environment.*variable\|solution"
  export TIDB_UPGRADE_PRECHECK_KB=/home/bearc/workspace/sourcecode/tidb-upgrade-precheck/knowledge</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-5-test-5.6-cp3-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-5-test-5.6-cp3-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
</div>
</div></div>

        <div class="phase">
            <h3 class="collapsible" onclick="toggleSection(this)">Phase 6: 报告验证</h3>
            <p style="margin: 10px 0; color: #666;"><strong>目标:</strong> </p>
            <div class="collapsed-content">

                <div class="test">
                    <div class="test-header">
                        <input type="checkbox" class="test-checkbox" data-id="phase-6-test-5.6" onchange="updateProgress()">
                        <h4>Test 5.6: 缺少环境变量（知识库路径）</h4>
                    </div>

                    <div class="command-block">
                        <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                        <pre>unset TIDB_UPGRADE_PRECHECK_KB
./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck</pre>
                    </div>

                    <textarea class="remark-input" placeholder="添加测试备注..." data-id="phase-6-test-5.6-remark" onblur="saveRemark(this)"></textarea>
                    <div class="remark-display" data-id="phase-6-test-5.6-remark-display" style="display: none;"></div>
<h4>验证点</h4>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-6-test-5.6-cp1" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>TiUP 尝试从其他位置查找知识库</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>unset TIDB_UPGRADE_PRECHECK_KB
  ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck 2>&1 | grep -i "trying\|looking.*for\|searching.*knowledge"
  export TIDB_UPGRADE_PRECHECK_KB=/home/bearc/workspace/sourcecode/tidb-upgrade-precheck/knowledge</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-6-test-5.6-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-6-test-5.6-cp1-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-6-test-5.6-cp2" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>或显示清晰的错误信息</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>unset TIDB_UPGRADE_PRECHECK_KB
  ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck 2>&1 | grep -i "error.*knowledge\|knowledge.*not found\|cannot.*find.*knowledge"
  export TIDB_UPGRADE_PRECHECK_KB=/home/bearc/workspace/sourcecode/tidb-upgrade-precheck/knowledge</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-6-test-5.6-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-6-test-5.6-cp2-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-6-test-5.6-cp3" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>错误信息包含解决建议</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>unset TIDB_UPGRADE_PRECHECK_KB
  ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck 2>&1 | grep -i "set.*TIDB_UPGRADE_PRECHECK_KB\|environment.*variable\|solution"
  export TIDB_UPGRADE_PRECHECK_KB=/home/bearc/workspace/sourcecode/tidb-upgrade-precheck/knowledge</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-6-test-5.6-cp3-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-6-test-5.6-cp3-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
</div>

                <div class="test">
                    <div class="test-header">
                        <input type="checkbox" class="test-checkbox" data-id="phase-6-test-6.1" onchange="updateProgress()">
                        <h4>Test 6.1: 验证 Text 报告内容</h4>
                    </div>

                    <div class="command-block">
                        <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                        <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 \
  --precheck \
  --precheck-output text > /tmp/precheck-text.txt

# 检查报告内容
cat /tmp/precheck-text.txt</pre>
                    </div>

                    <textarea class="remark-input" placeholder="添加测试备注..." data-id="phase-6-test-6.1-remark" onblur="saveRemark(this)"></textarea>
                    <div class="remark-display" data-id="phase-6-test-6.1-remark-display" style="display: none;"></div>
<h4>验证点</h4>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-6-test-6.1-cp1" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>包含源版本信息</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>cat /tmp/precheck-text.txt | grep -i "source.*version\|from.*version" | head -2</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-6-test-6.1-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-6-test-6.1-cp1-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-6-test-6.1-cp2" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>包含目标版本信息</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>cat /tmp/precheck-text.txt | grep -i "target.*version\|to.*version" | head -2</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-6-test-6.1-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-6-test-6.1-cp2-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-6-test-6.1-cp3" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>包含配置检查结果</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>cat /tmp/precheck-text.txt | grep -i "config.*check\|configuration.*result" | head -3</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-6-test-6.1-cp3-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-6-test-6.1-cp3-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-6-test-6.1-cp4" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>包含系统变量检查结果</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>cat /tmp/precheck-text.txt | grep -i "system.*variable\|variable.*check" | head -3</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-6-test-6.1-cp4-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-6-test-6.1-cp4-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-6-test-6.1-cp5" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>包含兼容性检查结果</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>cat /tmp/precheck-text.txt | grep -i "compatibility\|compatible" | head -3</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-6-test-6.1-cp5-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-6-test-6.1-cp5-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-6-test-6.1-cp6" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>包含风险等级（如果有）</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>cat /tmp/precheck-text.txt | grep -E "risk|severity|error|warning" | head -5</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-6-test-6.1-cp6-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-6-test-6.1-cp6-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
</div>

                <div class="test">
                    <div class="test-header">
                        <input type="checkbox" class="test-checkbox" data-id="phase-6-test-6.2" onchange="updateProgress()">
                        <h4>Test 6.2: 验证 HTML 报告内容</h4>
                    </div>

                    <div class="command-block">
                        <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                        <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 \
  --precheck \
  --precheck-output html

# 检查报告文件
REPORT_FILE=$(ls -t ~/.tiup/storage/cluster/upgrade_precheck/reports/*.html | head -1)
echo "Report file: $REPORT_FILE"

# 在浏览器中打开
open "$REPORT_FILE"</pre>
                    </div>

                    <textarea class="remark-input" placeholder="添加测试备注..." data-id="phase-6-test-6.2-remark" onblur="saveRemark(this)"></textarea>
                    <div class="remark-display" data-id="phase-6-test-6.2-remark-display" style="display: none;"></div>
<h4>验证点</h4>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-6-test-6.2-cp1" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>HTML 格式正确</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>REPORT_FILE=$(ls -t ~/.tiup/storage/cluster/upgrade_precheck/reports/*.html | head -1)
  python3 -c "import html.parser; parser = html.parser.HTMLParser(); open('$REPORT_FILE').read()" 2>&1 && echo "✓ Valid HTML" || echo "✗ Invalid HTML"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-6-test-6.2-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-6-test-6.2-cp1-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-6-test-6.2-cp2" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>可以在浏览器中正常显示</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>REPORT_FILE=$(ls -t ~/.tiup/storage/cluster/upgrade_precheck/reports/*.html | head -1)
  open "$REPORT_FILE"  # macOS
  # 手动检查浏览器显示是否正常</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-6-test-6.2-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-6-test-6.2-cp2-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-6-test-6.2-cp3" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>包含所有检查结果</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>REPORT_FILE=$(ls -t ~/.tiup/storage/cluster/upgrade_precheck/reports/*.html | head -1)
  grep -i "source.*version\|target.*version\|check.*result\|summary" "$REPORT_FILE" | head -5</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-6-test-6.2-cp3-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-6-test-6.2-cp3-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-6-test-6.2-cp4" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>样式正确</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>REPORT_FILE=$(ls -t ~/.tiup/storage/cluster/upgrade_precheck/reports/*.html | head -1)
  grep -E "<style|\.css" "$REPORT_FILE" | head -3</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-6-test-6.2-cp4-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-6-test-6.2-cp4-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-6-test-6.2-cp5" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>链接和交互正常（如果有）</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>REPORT_FILE=$(ls -t ~/.tiup/storage/cluster/upgrade_precheck/reports/*.html | head -1)
  grep -E "<a href|onclick|button" "$REPORT_FILE" | head -3</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-6-test-6.2-cp5-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-6-test-6.2-cp5-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
</div>

                <div class="test">
                    <div class="test-header">
                        <input type="checkbox" class="test-checkbox" data-id="phase-6-test-6.3" onchange="updateProgress()">
                        <h4>Test 6.3: 验证 JSON 报告内容</h4>
                    </div>

                    <div class="command-block">
                        <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                        <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 \
  --precheck \
  --precheck-output json

# 检查报告文件
REPORT_FILE=$(ls -t ~/.tiup/storage/cluster/upgrade_precheck/reports/*.json | head -1)
echo "Report file: $REPORT_FILE"

# 验证 JSON 格式
python3 -m json.tool "$REPORT_FILE" > /dev/null && echo "✓ JSON valid" || echo "✗ JSON invalid"

# 查看内容
cat "$REPORT_FILE" | python3 -m json.tool | head -50</pre>
                    </div>

                    <textarea class="remark-input" placeholder="添加测试备注..." data-id="phase-6-test-6.3-remark" onblur="saveRemark(this)"></textarea>
                    <div class="remark-display" data-id="phase-6-test-6.3-remark-display" style="display: none;"></div>
<h4>验证点</h4>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-6-test-6.3-cp1" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>JSON 格式有效</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>REPORT_FILE=$(ls -t ~/.tiup/storage/cluster/upgrade_precheck/reports/*.json | head -1)
  python3 -m json.tool "$REPORT_FILE" > /dev/null 2>&1 && echo "✓ Valid JSON" || echo "✗ Invalid JSON"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-6-test-6.3-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-6-test-6.3-cp1-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-6-test-6.3-cp2" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>包含所有必需字段</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>REPORT_FILE=$(ls -t ~/.tiup/storage/cluster/upgrade_precheck/reports/*.json | head -1)
  python3 -c "import json; d=json.load(open('$REPORT_FILE')); print('Fields:', list(d.keys()))"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-6-test-6.3-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-6-test-6.3-cp2-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-6-test-6.3-cp3" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>结构符合预期</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>REPORT_FILE=$(ls -t ~/.tiup/storage/cluster/upgrade_precheck/reports/*.json | head -1)
  python3 -c "import json; d=json.load(open('$REPORT_FILE')); print('Has source_version:', 'source_version' in d); print('Has target_version:', 'target_version' in d); print('Has check_results:', 'check_results' in d)"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-6-test-6.3-cp3-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-6-test-6.3-cp3-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-6-test-6.3-cp4" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>数据完整</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>REPORT_FILE=$(ls -t ~/.tiup/storage/cluster/upgrade_precheck/reports/*.json | head -1)
  python3 -c "import json; d=json.load(open('$REPORT_FILE')); print('Source version:', d.get('source_version')); print('Target version:', d.get('target_version')); print('Check results count:', len(d.get('check_results', [])))"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-6-test-6.3-cp4-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-6-test-6.3-cp4-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
</div>
</div></div>

        <div class="phase">
            <h3 class="collapsible" onclick="toggleSection(this)">Phase 7: 集成验证</h3>
            <p style="margin: 10px 0; color: #666;"><strong>目标:</strong> </p>
            <div class="collapsed-content">

                <div class="test">
                    <div class="test-header">
                        <input type="checkbox" class="test-checkbox" data-id="phase-7-test-6.3" onchange="updateProgress()">
                        <h4>Test 6.3: 验证 JSON 报告内容</h4>
                    </div>

                    <div class="command-block">
                        <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                        <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 \
  --precheck \
  --precheck-output json

# 检查报告文件
REPORT_FILE=$(ls -t ~/.tiup/storage/cluster/upgrade_precheck/reports/*.json | head -1)
echo "Report file: $REPORT_FILE"

# 验证 JSON 格式
python3 -m json.tool "$REPORT_FILE" > /dev/null && echo "✓ JSON valid" || echo "✗ JSON invalid"

# 查看内容
cat "$REPORT_FILE" | python3 -m json.tool | head -50</pre>
                    </div>

                    <textarea class="remark-input" placeholder="添加测试备注..." data-id="phase-7-test-6.3-remark" onblur="saveRemark(this)"></textarea>
                    <div class="remark-display" data-id="phase-7-test-6.3-remark-display" style="display: none;"></div>
<h4>验证点</h4>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-7-test-6.3-cp1" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>JSON 格式有效</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>REPORT_FILE=$(ls -t ~/.tiup/storage/cluster/upgrade_precheck/reports/*.json | head -1)
  python3 -m json.tool "$REPORT_FILE" > /dev/null 2>&1 && echo "✓ Valid JSON" || echo "✗ Invalid JSON"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-7-test-6.3-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-7-test-6.3-cp1-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-7-test-6.3-cp2" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>包含所有必需字段</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>REPORT_FILE=$(ls -t ~/.tiup/storage/cluster/upgrade_precheck/reports/*.json | head -1)
  python3 -c "import json; d=json.load(open('$REPORT_FILE')); print('Fields:', list(d.keys()))"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-7-test-6.3-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-7-test-6.3-cp2-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-7-test-6.3-cp3" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>结构符合预期</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>REPORT_FILE=$(ls -t ~/.tiup/storage/cluster/upgrade_precheck/reports/*.json | head -1)
  python3 -c "import json; d=json.load(open('$REPORT_FILE')); print('Has source_version:', 'source_version' in d); print('Has target_version:', 'target_version' in d); print('Has check_results:', 'check_results' in d)"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-7-test-6.3-cp3-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-7-test-6.3-cp3-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-7-test-6.3-cp4" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>数据完整</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>REPORT_FILE=$(ls -t ~/.tiup/storage/cluster/upgrade_precheck/reports/*.json | head -1)
  python3 -c "import json; d=json.load(open('$REPORT_FILE')); print('Source version:', d.get('source_version')); print('Target version:', d.get('target_version')); print('Check results count:', len(d.get('check_results', [])))"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-7-test-6.3-cp4-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-7-test-6.3-cp4-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
</div>

                <div class="test">
                    <div class="test-header">
                        <input type="checkbox" class="test-checkbox" data-id="phase-7-test-7.1" onchange="updateProgress()">
                        <h4>Test 7.1: 验证拓扑文件生成</h4>
                    </div>

                    <div class="command-block">
                        <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                        <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck

# 检查拓扑文件
TOPOLOGY_FILE=$(ls -t ~/.tiup/storage/cluster/upgrade_precheck/tmp/topology-*.yaml | head -1)
echo "Topology file: $TOPOLOGY_FILE"
cat "$TOPOLOGY_FILE"</pre>
                    </div>

                    <textarea class="remark-input" placeholder="添加测试备注..." data-id="phase-7-test-7.1-remark" onblur="saveRemark(this)"></textarea>
                    <div class="remark-display" data-id="phase-7-test-7.1-remark-display" style="display: none;"></div>
<h4>验证点</h4>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-7-test-7.1-cp1" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>拓扑文件生成</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>ls -lh ~/.tiup/storage/cluster/upgrade_precheck/tmp/topology-*.yaml</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-7-test-7.1-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-7-test-7.1-cp1-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-7-test-7.1-cp2" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>包含集群信息</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>TOPOLOGY_FILE=$(ls -t ~/.tiup/storage/cluster/upgrade_precheck/tmp/topology-*.yaml | head -1)
  grep -E "cluster|tidb_servers|tikv_servers|pd_servers" "$TOPOLOGY_FILE" | head -5</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-7-test-7.1-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-7-test-7.1-cp2-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-7-test-7.1-cp3" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>包含源版本信息</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>TOPOLOGY_FILE=$(ls -t ~/.tiup/storage/cluster/upgrade_precheck/tmp/topology-*.yaml | head -1)
  grep -i "version\|v7.5.1" "$TOPOLOGY_FILE" | head -3</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-7-test-7.1-cp3-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-7-test-7.1-cp3-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-7-test-7.1-cp4" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>包含所有组件配置</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>TOPOLOGY_FILE=$(ls -t ~/.tiup/storage/cluster/upgrade_precheck/tmp/topology-*.yaml | head -1)
  grep -E "tidb_servers|tikv_servers|pd_servers" "$TOPOLOGY_FILE" | head -5</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-7-test-7.1-cp4-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-7-test-7.1-cp4-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-7-test-7.1-cp5" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>YAML 格式正确</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>TOPOLOGY_FILE=$(ls -t ~/.tiup/storage/cluster/upgrade_precheck/tmp/topology-*.yaml | head -1)
  python3 -c "import yaml; yaml.safe_load(open('$TOPOLOGY_FILE'))" 2>&1 && echo "✓ Valid YAML" || echo "✗ Invalid YAML"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-7-test-7.1-cp5-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-7-test-7.1-cp5-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
</div>

                <div class="test">
                    <div class="test-header">
                        <input type="checkbox" class="test-checkbox" data-id="phase-7-test-7.2" onchange="updateProgress()">
                        <h4>Test 7.2: 验证命令参数传递</h4>
                    </div>

                    <div class="command-block">
                        <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                        <pre># 启用详细日志（如果支持）
export TIUP_LOG_LEVEL=debug

./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 \
  --precheck \
  --precheck-output html \
  --precheck-tidb-user root 2>&1 | grep -i "executing\|command"</pre>
                    </div>

                    <textarea class="remark-input" placeholder="添加测试备注..." data-id="phase-7-test-7.2-remark" onblur="saveRemark(this)"></textarea>
                    <div class="remark-display" data-id="phase-7-test-7.2-remark-display" style="display: none;"></div>
<h4>验证点</h4>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-7-test-7.2-cp1" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>命令包含 --topology-file</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck --precheck-output html --precheck-tidb-user root 2>&1 | grep "Executing:" | grep -- "--topology-file"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-7-test-7.2-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-7-test-7.2-cp1-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-7-test-7.2-cp2" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>命令包含 --target-version</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck --precheck-output html --precheck-tidb-user root 2>&1 | grep "Executing:" | grep -- "--target-version.*v8.5.4"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-7-test-7.2-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-7-test-7.2-cp2-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-7-test-7.2-cp3" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>命令包含 --format</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck --precheck-output html --precheck-tidb-user root 2>&1 | grep "Executing:" | grep -- "--format.*html"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-7-test-7.2-cp3-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-7-test-7.2-cp3-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-7-test-7.2-cp4" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>命令包含 --output-dir</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck --precheck-output html --precheck-tidb-user root 2>&1 | grep "Executing:" | grep -- "--output-dir"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-7-test-7.2-cp4-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-7-test-7.2-cp4-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-7-test-7.2-cp5" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>命令包含 --source-version</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck --precheck-output html --precheck-tidb-user root 2>&1 | grep "Executing:" | grep -- "--source-version"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-7-test-7.2-cp5-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-7-test-7.2-cp5-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-7-test-7.2-cp6" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>命令包含 --tidb-user</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck --precheck-output html --precheck-tidb-user root 2>&1 | grep "Executing:" | grep -- "--tidb-user.*root"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-7-test-7.2-cp6-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-7-test-7.2-cp6-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-7-test-7.2-cp7" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>所有参数值正确</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck --precheck-output html --precheck-tidb-user root 2>&1 | grep "Executing:" | head -1
  # 手动检查所有参数值是否正确</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-7-test-7.2-cp7-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-7-test-7.2-cp7-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
</div>

                <div class="test">
                    <div class="test-header">
                        <input type="checkbox" class="test-checkbox" data-id="phase-7-test-7.3" onchange="updateProgress()">
                        <h4>Test 7.3: 验证工作目录</h4>
                    </div>

                    <div class="command-block">
                        <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                        <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck 2>&1 | grep -i "knowledge\|working"</pre>
                    </div>

                    <textarea class="remark-input" placeholder="添加测试备注..." data-id="phase-7-test-7.3-remark" onblur="saveRemark(this)"></textarea>
                    <div class="remark-display" data-id="phase-7-test-7.3-remark-display" style="display: none;"></div>
<h4>验证点</h4>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-7-test-7.3-cp1" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>工作目录设置正确</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck 2>&1 | grep -i "working.*directory\|knowledge.*base.*path"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-7-test-7.3-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-7-test-7.3-cp1-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-7-test-7.3-cp2" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>知识库路径可访问</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>ls -d "$TIDB_UPGRADE_PRECHECK_KB" && echo "✓ KB path accessible" || echo "✗ KB path not accessible"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-7-test-7.3-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-7-test-7.3-cp2-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-7-test-7.3-cp3" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Precheck 可以找到知识库</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck 2>&1 | grep -i "knowledge.*base.*found\|using.*knowledge" && echo "✓ KB found" || echo "✗ KB not found"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-7-test-7.3-cp3-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-7-test-7.3-cp3-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
</div>

                <div class="test">
                    <div class="test-header">
                        <input type="checkbox" class="test-checkbox" data-id="phase-7-test-7.4" onchange="updateProgress()">
                        <h4>Test 7.4: 验证报告路径提取</h4>
                    </div>

                    <div class="command-block">
                        <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                        <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 \
  --precheck \
  --precheck-output html 2>&1 | grep -i "report generated"</pre>
                    </div>

                    <textarea class="remark-input" placeholder="添加测试备注..." data-id="phase-7-test-7.4-remark" onblur="saveRemark(this)"></textarea>
                    <div class="remark-display" data-id="phase-7-test-7.4-remark-display" style="display: none;"></div>
<h4>验证点</h4>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-7-test-7.4-cp1" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>报告路径从输出中提取</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck --precheck-output html 2>&1 | grep -E "Report generated|report.*\.html"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-7-test-7.4-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-7-test-7.4-cp1-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-7-test-7.4-cp2" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>报告文件存在于提取的路径</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>REPORT_PATH=$(./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck --precheck-output html 2>&1 | grep -oE "Report generated:.*\.html" | cut -d: -f2 | tr -d ' ')
  if [ -n "$REPORT_PATH" ]; then
    ls -lh "$REPORT_PATH" && echo "✓ Report file exists" || echo "✗ Report file not found"
  fi</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-7-test-7.4-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-7-test-7.4-cp2-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-7-test-7.4-cp3" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>报告文件可读</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>REPORT_FILE=$(ls -t ~/.tiup/storage/cluster/upgrade_precheck/reports/*.html | head -1)
  [ -r "$REPORT_FILE" ] && echo "✓ Report file readable" || echo "✗ Report file not readable"
  cat "$REPORT_FILE" | head -10</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-7-test-7.4-cp3-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-7-test-7.4-cp3-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
</div>
</div></div>

        <div class="phase">
            <h3 class="collapsible" onclick="toggleSection(this)">Phase 8: 性能测试</h3>
            <p style="margin: 10px 0; color: #666;"><strong>目标:</strong> </p>
            <div class="collapsed-content">

                <div class="test">
                    <div class="test-header">
                        <input type="checkbox" class="test-checkbox" data-id="phase-8-test-7.4" onchange="updateProgress()">
                        <h4>Test 7.4: 验证报告路径提取</h4>
                    </div>

                    <div class="command-block">
                        <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                        <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 \
  --precheck \
  --precheck-output html 2>&1 | grep -i "report generated"</pre>
                    </div>

                    <textarea class="remark-input" placeholder="添加测试备注..." data-id="phase-8-test-7.4-remark" onblur="saveRemark(this)"></textarea>
                    <div class="remark-display" data-id="phase-8-test-7.4-remark-display" style="display: none;"></div>
<h4>验证点</h4>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-7.4-cp1" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>报告路径从输出中提取</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck --precheck-output html 2>&1 | grep -E "Report generated|report.*\.html"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-7.4-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-7.4-cp1-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-7.4-cp2" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>报告文件存在于提取的路径</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>REPORT_PATH=$(./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck --precheck-output html 2>&1 | grep -oE "Report generated:.*\.html" | cut -d: -f2 | tr -d ' ')
  if [ -n "$REPORT_PATH" ]; then
    ls -lh "$REPORT_PATH" && echo "✓ Report file exists" || echo "✗ Report file not found"
  fi</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-7.4-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-7.4-cp2-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-7.4-cp3" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>报告文件可读</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>REPORT_FILE=$(ls -t ~/.tiup/storage/cluster/upgrade_precheck/reports/*.html | head -1)
  [ -r "$REPORT_FILE" ] && echo "✓ Report file readable" || echo "✗ Report file not readable"
  cat "$REPORT_FILE" | head -10</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-7.4-cp3-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-7.4-cp3-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
</div>

                <div class="test">
                    <div class="test-header">
                        <input type="checkbox" class="test-checkbox" data-id="phase-8-test-8.1" onchange="updateProgress()">
                        <h4>Test 8.1: 测量 Precheck 执行时间</h4>
                    </div>

                    <div class="command-block">
                        <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                        <pre>time ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck</pre>
                    </div>

                    <textarea class="remark-input" placeholder="添加测试备注..." data-id="phase-8-test-8.1-remark" onblur="saveRemark(this)"></textarea>
                    <div class="remark-display" data-id="phase-8-test-8.1-remark-display" style="display: none;"></div>
<h4>验证点</h4>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-8.1-cp1" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Precheck 在合理时间内完成（< 2 分钟，小集群）</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre>time ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck
  # 检查 real 时间是否 < 2 分钟</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-8.1-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-8.1-cp1-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-8.1-cp2" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>没有明显的性能问题</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 在另一个终端监控资源使用
  # top -pid $(pgrep -f "tiup-cluster") -l 1
  ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck
  # 检查是否有明显的延迟或卡顿</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-8.1-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-8.1-cp2-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
</div>

                <div class="test">
                    <div class="test-header">
                        <input type="checkbox" class="test-checkbox" data-id="phase-8-test-8.2" onchange="updateProgress()">
                        <h4>Test 8.2: 资源使用</h4>
                    </div>

                    <div class="command-block">
                        <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                        <pre># 检查输出目录
ls -la ~/.tiup/storage/cluster/upgrade_precheck/reports/

# 检查权限
ls -ld ~/.tiup/storage/cluster/upgrade_precheck/reports/

# 检查日志
cat ~/.tiup/logs/tiup-cluster-debug-*.log | grep -i "report\|error"</pre>
                    </div>

                    <textarea class="remark-input" placeholder="添加测试备注..." data-id="phase-8-test-8.2-remark" onblur="saveRemark(this)"></textarea>
                    <div class="remark-display" data-id="phase-8-test-8.2-remark-display" style="display: none;"></div>
<h4>验证点</h4>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-8.2-cp1" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>内存使用合理</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 在另一个终端执行
  # ps aux | grep "tiup-cluster\|upgrade-precheck" | grep -v grep | awk '{print "Memory:", $6/1024 "MB"}'
  ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck &
  PID=$!
  sleep 5
  ps -p $PID -o rss= | awk '{print "Memory usage:", $1/1024 "MB"}'
  wait $PID</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-8.2-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-8.2-cp1-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-8.2-cp2" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>CPU 使用合理</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 在另一个终端执行
  # top -pid $(pgrep -f "tiup-cluster") -l 1 | grep "CPU usage"
  ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck &
  PID=$!
  sleep 5
  ps -p $PID -o %cpu= | awk '{print "CPU usage:", $1 "%"}'
  wait $PID</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-8.2-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-8.2-cp2-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-8.2-cp3" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>没有资源泄漏</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 执行多次 precheck，检查资源使用是否稳定
  for i in {1..3}; do
    echo "Run $i:"
    ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck > /dev/null 2>&1
    sleep 2
  done
  # 检查进程是否都正常退出
  ps aux | grep "tiup-cluster\|upgrade-precheck" | grep -v grep && echo "✗ Process still running" || echo "✓ All processes exited"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-8.2-cp3-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-8.2-cp3-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-8.2-cp4" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>TiUP 已安装或构建</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-8.2-cp4-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-8.2-cp4-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-8.2-cp5" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>tidb-upgrade-precheck 已构建</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-8.2-cp5-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-8.2-cp5-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-8.2-cp6" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>知识库已生成</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-8.2-cp6-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-8.2-cp6-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-8.2-cp7" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>测试集群已部署并运行</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-8.2-cp7-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-8.2-cp7-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-8.2-cp8" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>环境变量已设置</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-8.2-cp8-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-8.2-cp8-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-8.2-cp9" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 1.1: 基本 Precheck-Only 测试</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-8.2-cp9-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-8.2-cp9-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-8.2-cp10" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 1.2: Text 格式</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-8.2-cp10-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-8.2-cp10-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-8.2-cp11" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 1.3: HTML 格式</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-8.2-cp11-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-8.2-cp11-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-8.2-cp12" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 1.4: Markdown 格式</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-8.2-cp12-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-8.2-cp12-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-8.2-cp13" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 1.5: 自定义输出文件</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-8.2-cp13-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-8.2-cp13-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-8.2-cp14" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 2.1: 默认升级流程</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-8.2-cp14-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-8.2-cp14-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-8.2-cp15" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 2.2: HTML 报告</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-8.2-cp15-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-8.2-cp15-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-8.2-cp16" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 2.3: 跳过确认</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-8.2-cp16-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-8.2-cp16-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-8.2-cp17" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 3.1: 默认用户</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-8.2-cp17-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-8.2-cp17-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-8.2-cp18" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 3.2: 自定义用户</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-8.2-cp18-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-8.2-cp18-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-8.2-cp19" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 3.3: 密码提示</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-8.2-cp19-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-8.2-cp19-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-8.2-cp20" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 3.4: 密码文件</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-8.2-cp20-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-8.2-cp20-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-8.2-cp21" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 4.1: 创建配置文件</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-8.2-cp21-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-8.2-cp21-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-8.2-cp22" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 4.2: 使用自定义配置</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-8.2-cp22-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-8.2-cp22-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-8.2-cp23" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 4.3: 使用默认配置位置</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-8.2-cp23-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-8.2-cp23-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-8.2-cp24" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.1: 跳过 Precheck</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-8.2-cp24-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-8.2-cp24-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-8.2-cp25" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.2: Precheck 失败但继续</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-8.2-cp25-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-8.2-cp25-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-8.2-cp26" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.3: 无效集群名称</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-8.2-cp26-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-8.2-cp26-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-8.2-cp27" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.4: 无效目标版本</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-8.2-cp27-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-8.2-cp27-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-8.2-cp28" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.5: 缺少二进制路径</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-8.2-cp28-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-8.2-cp28-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-8.2-cp29" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.6: 缺少知识库路径</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-8.2-cp29-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-8.2-cp29-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-8.2-cp30" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 6.1: Text 报告内容</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-8.2-cp30-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-8.2-cp30-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-8.2-cp31" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 6.2: HTML 报告内容</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-8.2-cp31-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-8.2-cp31-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-8.2-cp32" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 6.3: JSON 报告内容</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-8.2-cp32-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-8.2-cp32-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-8.2-cp33" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 7.1: 拓扑文件生成</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-8.2-cp33-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-8.2-cp33-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-8.2-cp34" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 7.2: 命令参数传递</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-8.2-cp34-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-8.2-cp34-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-8.2-cp35" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 7.3: 工作目录</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-8.2-cp35-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-8.2-cp35-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-8.2-cp36" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 7.4: 报告路径提取</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-8.2-cp36-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-8.2-cp36-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-8.2-cp37" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 8.1: 执行时间</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-8.2-cp37-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-8.2-cp37-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-8.2-cp38" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 8.2: 资源使用</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-8.2-cp38-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-8.2-cp38-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-8.2-cp39" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>所有测试通过</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-8.2-cp39-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-8.2-cp39-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-8.2-cp40" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>部分测试通过</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-8.2-cp40-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-8.2-cp40-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-8-test-8.2-cp41" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>测试失败</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-8-test-8.2-cp41-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-8-test-8.2-cp41-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
</div>
</div></div>

        <div class="phase">
            <h3 class="collapsible" onclick="toggleSection(this)">Phase 1: Precheck-Only 模式</h3>
            <p style="margin: 10px 0; color: #666;"><strong>目标:</strong> </p>
            <div class="collapsed-content">

                <div class="test">
                    <div class="test-header">
                        <input type="checkbox" class="test-checkbox" data-id="phase-9-test-8.2" onchange="updateProgress()">
                        <h4>Test 8.2: 资源使用</h4>
                    </div>

                    <div class="command-block">
                        <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                        <pre># 检查输出目录
ls -la ~/.tiup/storage/cluster/upgrade_precheck/reports/

# 检查权限
ls -ld ~/.tiup/storage/cluster/upgrade_precheck/reports/

# 检查日志
cat ~/.tiup/logs/tiup-cluster-debug-*.log | grep -i "report\|error"</pre>
                    </div>

                    <textarea class="remark-input" placeholder="添加测试备注..." data-id="phase-9-test-8.2-remark" onblur="saveRemark(this)"></textarea>
                    <div class="remark-display" data-id="phase-9-test-8.2-remark-display" style="display: none;"></div>
<h4>验证点</h4>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-9-test-8.2-cp1" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>内存使用合理</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 在另一个终端执行
  # ps aux | grep "tiup-cluster\|upgrade-precheck" | grep -v grep | awk '{print "Memory:", $6/1024 "MB"}'
  ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck &
  PID=$!
  sleep 5
  ps -p $PID -o rss= | awk '{print "Memory usage:", $1/1024 "MB"}'
  wait $PID</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-9-test-8.2-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-9-test-8.2-cp1-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-9-test-8.2-cp2" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>CPU 使用合理</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 在另一个终端执行
  # top -pid $(pgrep -f "tiup-cluster") -l 1 | grep "CPU usage"
  ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck &
  PID=$!
  sleep 5
  ps -p $PID -o %cpu= | awk '{print "CPU usage:", $1 "%"}'
  wait $PID</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-9-test-8.2-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-9-test-8.2-cp2-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-9-test-8.2-cp3" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>没有资源泄漏</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 执行多次 precheck，检查资源使用是否稳定
  for i in {1..3}; do
    echo "Run $i:"
    ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck > /dev/null 2>&1
    sleep 2
  done
  # 检查进程是否都正常退出
  ps aux | grep "tiup-cluster\|upgrade-precheck" | grep -v grep && echo "✗ Process still running" || echo "✓ All processes exited"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-9-test-8.2-cp3-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-9-test-8.2-cp3-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-9-test-8.2-cp4" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>TiUP 已安装或构建</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-9-test-8.2-cp4-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-9-test-8.2-cp4-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-9-test-8.2-cp5" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>tidb-upgrade-precheck 已构建</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-9-test-8.2-cp5-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-9-test-8.2-cp5-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-9-test-8.2-cp6" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>知识库已生成</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-9-test-8.2-cp6-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-9-test-8.2-cp6-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-9-test-8.2-cp7" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>测试集群已部署并运行</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-9-test-8.2-cp7-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-9-test-8.2-cp7-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-9-test-8.2-cp8" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>环境变量已设置</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-9-test-8.2-cp8-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-9-test-8.2-cp8-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-9-test-8.2-cp9" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 1.1: 基本 Precheck-Only 测试</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-9-test-8.2-cp9-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-9-test-8.2-cp9-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-9-test-8.2-cp10" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 1.2: Text 格式</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-9-test-8.2-cp10-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-9-test-8.2-cp10-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-9-test-8.2-cp11" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 1.3: HTML 格式</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-9-test-8.2-cp11-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-9-test-8.2-cp11-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-9-test-8.2-cp12" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 1.4: Markdown 格式</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-9-test-8.2-cp12-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-9-test-8.2-cp12-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-9-test-8.2-cp13" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 1.5: 自定义输出文件</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-9-test-8.2-cp13-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-9-test-8.2-cp13-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-9-test-8.2-cp14" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 2.1: 默认升级流程</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-9-test-8.2-cp14-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-9-test-8.2-cp14-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-9-test-8.2-cp15" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 2.2: HTML 报告</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-9-test-8.2-cp15-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-9-test-8.2-cp15-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-9-test-8.2-cp16" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 2.3: 跳过确认</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-9-test-8.2-cp16-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-9-test-8.2-cp16-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-9-test-8.2-cp17" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 3.1: 默认用户</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-9-test-8.2-cp17-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-9-test-8.2-cp17-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-9-test-8.2-cp18" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 3.2: 自定义用户</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-9-test-8.2-cp18-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-9-test-8.2-cp18-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-9-test-8.2-cp19" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 3.3: 密码提示</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-9-test-8.2-cp19-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-9-test-8.2-cp19-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-9-test-8.2-cp20" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 3.4: 密码文件</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-9-test-8.2-cp20-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-9-test-8.2-cp20-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-9-test-8.2-cp21" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 4.1: 创建配置文件</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-9-test-8.2-cp21-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-9-test-8.2-cp21-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-9-test-8.2-cp22" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 4.2: 使用自定义配置</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-9-test-8.2-cp22-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-9-test-8.2-cp22-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-9-test-8.2-cp23" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 4.3: 使用默认配置位置</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-9-test-8.2-cp23-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-9-test-8.2-cp23-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-9-test-8.2-cp24" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.1: 跳过 Precheck</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-9-test-8.2-cp24-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-9-test-8.2-cp24-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-9-test-8.2-cp25" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.2: Precheck 失败但继续</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-9-test-8.2-cp25-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-9-test-8.2-cp25-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-9-test-8.2-cp26" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.3: 无效集群名称</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-9-test-8.2-cp26-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-9-test-8.2-cp26-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-9-test-8.2-cp27" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.4: 无效目标版本</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-9-test-8.2-cp27-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-9-test-8.2-cp27-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-9-test-8.2-cp28" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.5: 缺少二进制路径</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-9-test-8.2-cp28-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-9-test-8.2-cp28-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-9-test-8.2-cp29" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.6: 缺少知识库路径</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-9-test-8.2-cp29-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-9-test-8.2-cp29-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-9-test-8.2-cp30" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 6.1: Text 报告内容</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-9-test-8.2-cp30-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-9-test-8.2-cp30-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-9-test-8.2-cp31" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 6.2: HTML 报告内容</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-9-test-8.2-cp31-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-9-test-8.2-cp31-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-9-test-8.2-cp32" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 6.3: JSON 报告内容</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-9-test-8.2-cp32-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-9-test-8.2-cp32-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-9-test-8.2-cp33" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 7.1: 拓扑文件生成</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-9-test-8.2-cp33-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-9-test-8.2-cp33-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-9-test-8.2-cp34" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 7.2: 命令参数传递</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-9-test-8.2-cp34-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-9-test-8.2-cp34-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-9-test-8.2-cp35" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 7.3: 工作目录</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-9-test-8.2-cp35-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-9-test-8.2-cp35-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-9-test-8.2-cp36" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 7.4: 报告路径提取</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-9-test-8.2-cp36-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-9-test-8.2-cp36-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-9-test-8.2-cp37" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 8.1: 执行时间</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-9-test-8.2-cp37-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-9-test-8.2-cp37-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-9-test-8.2-cp38" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 8.2: 资源使用</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-9-test-8.2-cp38-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-9-test-8.2-cp38-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-9-test-8.2-cp39" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>所有测试通过</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-9-test-8.2-cp39-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-9-test-8.2-cp39-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-9-test-8.2-cp40" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>部分测试通过</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-9-test-8.2-cp40-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-9-test-8.2-cp40-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-9-test-8.2-cp41" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>测试失败</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-9-test-8.2-cp41-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-9-test-8.2-cp41-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
</div>
</div></div>

        <div class="phase">
            <h3 class="collapsible" onclick="toggleSection(this)">Phase 2: 完整升级流程</h3>
            <p style="margin: 10px 0; color: #666;"><strong>目标:</strong> </p>
            <div class="collapsed-content">

                <div class="test">
                    <div class="test-header">
                        <input type="checkbox" class="test-checkbox" data-id="phase-10-test-8.2" onchange="updateProgress()">
                        <h4>Test 8.2: 资源使用</h4>
                    </div>

                    <div class="command-block">
                        <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                        <pre># 检查输出目录
ls -la ~/.tiup/storage/cluster/upgrade_precheck/reports/

# 检查权限
ls -ld ~/.tiup/storage/cluster/upgrade_precheck/reports/

# 检查日志
cat ~/.tiup/logs/tiup-cluster-debug-*.log | grep -i "report\|error"</pre>
                    </div>

                    <textarea class="remark-input" placeholder="添加测试备注..." data-id="phase-10-test-8.2-remark" onblur="saveRemark(this)"></textarea>
                    <div class="remark-display" data-id="phase-10-test-8.2-remark-display" style="display: none;"></div>
<h4>验证点</h4>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-10-test-8.2-cp1" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>内存使用合理</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 在另一个终端执行
  # ps aux | grep "tiup-cluster\|upgrade-precheck" | grep -v grep | awk '{print "Memory:", $6/1024 "MB"}'
  ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck &
  PID=$!
  sleep 5
  ps -p $PID -o rss= | awk '{print "Memory usage:", $1/1024 "MB"}'
  wait $PID</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-10-test-8.2-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-10-test-8.2-cp1-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-10-test-8.2-cp2" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>CPU 使用合理</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 在另一个终端执行
  # top -pid $(pgrep -f "tiup-cluster") -l 1 | grep "CPU usage"
  ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck &
  PID=$!
  sleep 5
  ps -p $PID -o %cpu= | awk '{print "CPU usage:", $1 "%"}'
  wait $PID</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-10-test-8.2-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-10-test-8.2-cp2-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-10-test-8.2-cp3" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>没有资源泄漏</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 执行多次 precheck，检查资源使用是否稳定
  for i in {1..3}; do
    echo "Run $i:"
    ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck > /dev/null 2>&1
    sleep 2
  done
  # 检查进程是否都正常退出
  ps aux | grep "tiup-cluster\|upgrade-precheck" | grep -v grep && echo "✗ Process still running" || echo "✓ All processes exited"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-10-test-8.2-cp3-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-10-test-8.2-cp3-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-10-test-8.2-cp4" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>TiUP 已安装或构建</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-10-test-8.2-cp4-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-10-test-8.2-cp4-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-10-test-8.2-cp5" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>tidb-upgrade-precheck 已构建</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-10-test-8.2-cp5-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-10-test-8.2-cp5-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-10-test-8.2-cp6" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>知识库已生成</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-10-test-8.2-cp6-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-10-test-8.2-cp6-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-10-test-8.2-cp7" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>测试集群已部署并运行</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-10-test-8.2-cp7-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-10-test-8.2-cp7-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-10-test-8.2-cp8" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>环境变量已设置</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-10-test-8.2-cp8-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-10-test-8.2-cp8-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-10-test-8.2-cp9" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 1.1: 基本 Precheck-Only 测试</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-10-test-8.2-cp9-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-10-test-8.2-cp9-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-10-test-8.2-cp10" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 1.2: Text 格式</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-10-test-8.2-cp10-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-10-test-8.2-cp10-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-10-test-8.2-cp11" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 1.3: HTML 格式</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-10-test-8.2-cp11-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-10-test-8.2-cp11-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-10-test-8.2-cp12" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 1.4: Markdown 格式</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-10-test-8.2-cp12-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-10-test-8.2-cp12-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-10-test-8.2-cp13" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 1.5: 自定义输出文件</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-10-test-8.2-cp13-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-10-test-8.2-cp13-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-10-test-8.2-cp14" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 2.1: 默认升级流程</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-10-test-8.2-cp14-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-10-test-8.2-cp14-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-10-test-8.2-cp15" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 2.2: HTML 报告</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-10-test-8.2-cp15-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-10-test-8.2-cp15-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-10-test-8.2-cp16" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 2.3: 跳过确认</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-10-test-8.2-cp16-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-10-test-8.2-cp16-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-10-test-8.2-cp17" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 3.1: 默认用户</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-10-test-8.2-cp17-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-10-test-8.2-cp17-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-10-test-8.2-cp18" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 3.2: 自定义用户</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-10-test-8.2-cp18-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-10-test-8.2-cp18-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-10-test-8.2-cp19" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 3.3: 密码提示</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-10-test-8.2-cp19-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-10-test-8.2-cp19-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-10-test-8.2-cp20" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 3.4: 密码文件</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-10-test-8.2-cp20-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-10-test-8.2-cp20-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-10-test-8.2-cp21" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 4.1: 创建配置文件</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-10-test-8.2-cp21-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-10-test-8.2-cp21-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-10-test-8.2-cp22" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 4.2: 使用自定义配置</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-10-test-8.2-cp22-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-10-test-8.2-cp22-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-10-test-8.2-cp23" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 4.3: 使用默认配置位置</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-10-test-8.2-cp23-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-10-test-8.2-cp23-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-10-test-8.2-cp24" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.1: 跳过 Precheck</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-10-test-8.2-cp24-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-10-test-8.2-cp24-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-10-test-8.2-cp25" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.2: Precheck 失败但继续</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-10-test-8.2-cp25-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-10-test-8.2-cp25-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-10-test-8.2-cp26" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.3: 无效集群名称</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-10-test-8.2-cp26-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-10-test-8.2-cp26-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-10-test-8.2-cp27" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.4: 无效目标版本</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-10-test-8.2-cp27-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-10-test-8.2-cp27-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-10-test-8.2-cp28" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.5: 缺少二进制路径</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-10-test-8.2-cp28-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-10-test-8.2-cp28-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-10-test-8.2-cp29" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.6: 缺少知识库路径</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-10-test-8.2-cp29-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-10-test-8.2-cp29-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-10-test-8.2-cp30" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 6.1: Text 报告内容</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-10-test-8.2-cp30-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-10-test-8.2-cp30-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-10-test-8.2-cp31" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 6.2: HTML 报告内容</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-10-test-8.2-cp31-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-10-test-8.2-cp31-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-10-test-8.2-cp32" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 6.3: JSON 报告内容</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-10-test-8.2-cp32-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-10-test-8.2-cp32-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-10-test-8.2-cp33" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 7.1: 拓扑文件生成</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-10-test-8.2-cp33-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-10-test-8.2-cp33-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-10-test-8.2-cp34" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 7.2: 命令参数传递</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-10-test-8.2-cp34-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-10-test-8.2-cp34-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-10-test-8.2-cp35" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 7.3: 工作目录</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-10-test-8.2-cp35-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-10-test-8.2-cp35-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-10-test-8.2-cp36" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 7.4: 报告路径提取</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-10-test-8.2-cp36-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-10-test-8.2-cp36-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-10-test-8.2-cp37" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 8.1: 执行时间</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-10-test-8.2-cp37-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-10-test-8.2-cp37-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-10-test-8.2-cp38" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 8.2: 资源使用</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-10-test-8.2-cp38-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-10-test-8.2-cp38-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-10-test-8.2-cp39" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>所有测试通过</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-10-test-8.2-cp39-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-10-test-8.2-cp39-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-10-test-8.2-cp40" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>部分测试通过</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-10-test-8.2-cp40-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-10-test-8.2-cp40-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-10-test-8.2-cp41" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>测试失败</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-10-test-8.2-cp41-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-10-test-8.2-cp41-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
</div>
</div></div>

        <div class="phase">
            <h3 class="collapsible" onclick="toggleSection(this)">Phase 3: 凭证和认证</h3>
            <p style="margin: 10px 0; color: #666;"><strong>目标:</strong> </p>
            <div class="collapsed-content">

                <div class="test">
                    <div class="test-header">
                        <input type="checkbox" class="test-checkbox" data-id="phase-11-test-8.2" onchange="updateProgress()">
                        <h4>Test 8.2: 资源使用</h4>
                    </div>

                    <div class="command-block">
                        <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                        <pre># 检查输出目录
ls -la ~/.tiup/storage/cluster/upgrade_precheck/reports/

# 检查权限
ls -ld ~/.tiup/storage/cluster/upgrade_precheck/reports/

# 检查日志
cat ~/.tiup/logs/tiup-cluster-debug-*.log | grep -i "report\|error"</pre>
                    </div>

                    <textarea class="remark-input" placeholder="添加测试备注..." data-id="phase-11-test-8.2-remark" onblur="saveRemark(this)"></textarea>
                    <div class="remark-display" data-id="phase-11-test-8.2-remark-display" style="display: none;"></div>
<h4>验证点</h4>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-11-test-8.2-cp1" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>内存使用合理</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 在另一个终端执行
  # ps aux | grep "tiup-cluster\|upgrade-precheck" | grep -v grep | awk '{print "Memory:", $6/1024 "MB"}'
  ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck &
  PID=$!
  sleep 5
  ps -p $PID -o rss= | awk '{print "Memory usage:", $1/1024 "MB"}'
  wait $PID</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-11-test-8.2-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-11-test-8.2-cp1-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-11-test-8.2-cp2" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>CPU 使用合理</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 在另一个终端执行
  # top -pid $(pgrep -f "tiup-cluster") -l 1 | grep "CPU usage"
  ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck &
  PID=$!
  sleep 5
  ps -p $PID -o %cpu= | awk '{print "CPU usage:", $1 "%"}'
  wait $PID</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-11-test-8.2-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-11-test-8.2-cp2-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-11-test-8.2-cp3" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>没有资源泄漏</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 执行多次 precheck，检查资源使用是否稳定
  for i in {1..3}; do
    echo "Run $i:"
    ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck > /dev/null 2>&1
    sleep 2
  done
  # 检查进程是否都正常退出
  ps aux | grep "tiup-cluster\|upgrade-precheck" | grep -v grep && echo "✗ Process still running" || echo "✓ All processes exited"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-11-test-8.2-cp3-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-11-test-8.2-cp3-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-11-test-8.2-cp4" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>TiUP 已安装或构建</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-11-test-8.2-cp4-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-11-test-8.2-cp4-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-11-test-8.2-cp5" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>tidb-upgrade-precheck 已构建</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-11-test-8.2-cp5-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-11-test-8.2-cp5-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-11-test-8.2-cp6" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>知识库已生成</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-11-test-8.2-cp6-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-11-test-8.2-cp6-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-11-test-8.2-cp7" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>测试集群已部署并运行</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-11-test-8.2-cp7-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-11-test-8.2-cp7-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-11-test-8.2-cp8" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>环境变量已设置</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-11-test-8.2-cp8-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-11-test-8.2-cp8-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-11-test-8.2-cp9" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 1.1: 基本 Precheck-Only 测试</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-11-test-8.2-cp9-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-11-test-8.2-cp9-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-11-test-8.2-cp10" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 1.2: Text 格式</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-11-test-8.2-cp10-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-11-test-8.2-cp10-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-11-test-8.2-cp11" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 1.3: HTML 格式</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-11-test-8.2-cp11-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-11-test-8.2-cp11-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-11-test-8.2-cp12" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 1.4: Markdown 格式</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-11-test-8.2-cp12-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-11-test-8.2-cp12-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-11-test-8.2-cp13" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 1.5: 自定义输出文件</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-11-test-8.2-cp13-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-11-test-8.2-cp13-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-11-test-8.2-cp14" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 2.1: 默认升级流程</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-11-test-8.2-cp14-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-11-test-8.2-cp14-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-11-test-8.2-cp15" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 2.2: HTML 报告</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-11-test-8.2-cp15-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-11-test-8.2-cp15-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-11-test-8.2-cp16" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 2.3: 跳过确认</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-11-test-8.2-cp16-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-11-test-8.2-cp16-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-11-test-8.2-cp17" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 3.1: 默认用户</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-11-test-8.2-cp17-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-11-test-8.2-cp17-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-11-test-8.2-cp18" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 3.2: 自定义用户</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-11-test-8.2-cp18-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-11-test-8.2-cp18-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-11-test-8.2-cp19" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 3.3: 密码提示</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-11-test-8.2-cp19-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-11-test-8.2-cp19-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-11-test-8.2-cp20" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 3.4: 密码文件</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-11-test-8.2-cp20-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-11-test-8.2-cp20-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-11-test-8.2-cp21" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 4.1: 创建配置文件</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-11-test-8.2-cp21-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-11-test-8.2-cp21-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-11-test-8.2-cp22" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 4.2: 使用自定义配置</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-11-test-8.2-cp22-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-11-test-8.2-cp22-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-11-test-8.2-cp23" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 4.3: 使用默认配置位置</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-11-test-8.2-cp23-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-11-test-8.2-cp23-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-11-test-8.2-cp24" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.1: 跳过 Precheck</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-11-test-8.2-cp24-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-11-test-8.2-cp24-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-11-test-8.2-cp25" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.2: Precheck 失败但继续</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-11-test-8.2-cp25-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-11-test-8.2-cp25-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-11-test-8.2-cp26" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.3: 无效集群名称</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-11-test-8.2-cp26-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-11-test-8.2-cp26-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-11-test-8.2-cp27" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.4: 无效目标版本</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-11-test-8.2-cp27-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-11-test-8.2-cp27-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-11-test-8.2-cp28" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.5: 缺少二进制路径</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-11-test-8.2-cp28-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-11-test-8.2-cp28-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-11-test-8.2-cp29" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.6: 缺少知识库路径</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-11-test-8.2-cp29-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-11-test-8.2-cp29-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-11-test-8.2-cp30" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 6.1: Text 报告内容</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-11-test-8.2-cp30-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-11-test-8.2-cp30-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-11-test-8.2-cp31" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 6.2: HTML 报告内容</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-11-test-8.2-cp31-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-11-test-8.2-cp31-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-11-test-8.2-cp32" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 6.3: JSON 报告内容</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-11-test-8.2-cp32-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-11-test-8.2-cp32-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-11-test-8.2-cp33" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 7.1: 拓扑文件生成</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-11-test-8.2-cp33-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-11-test-8.2-cp33-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-11-test-8.2-cp34" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 7.2: 命令参数传递</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-11-test-8.2-cp34-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-11-test-8.2-cp34-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-11-test-8.2-cp35" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 7.3: 工作目录</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-11-test-8.2-cp35-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-11-test-8.2-cp35-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-11-test-8.2-cp36" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 7.4: 报告路径提取</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-11-test-8.2-cp36-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-11-test-8.2-cp36-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-11-test-8.2-cp37" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 8.1: 执行时间</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-11-test-8.2-cp37-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-11-test-8.2-cp37-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-11-test-8.2-cp38" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 8.2: 资源使用</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-11-test-8.2-cp38-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-11-test-8.2-cp38-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-11-test-8.2-cp39" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>所有测试通过</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-11-test-8.2-cp39-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-11-test-8.2-cp39-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-11-test-8.2-cp40" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>部分测试通过</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-11-test-8.2-cp40-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-11-test-8.2-cp40-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-11-test-8.2-cp41" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>测试失败</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-11-test-8.2-cp41-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-11-test-8.2-cp41-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
</div>
</div></div>

        <div class="phase">
            <h3 class="collapsible" onclick="toggleSection(this)">Phase 4: 高风险参数配置</h3>
            <p style="margin: 10px 0; color: #666;"><strong>目标:</strong> </p>
            <div class="collapsed-content">

                <div class="test">
                    <div class="test-header">
                        <input type="checkbox" class="test-checkbox" data-id="phase-12-test-8.2" onchange="updateProgress()">
                        <h4>Test 8.2: 资源使用</h4>
                    </div>

                    <div class="command-block">
                        <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                        <pre># 检查输出目录
ls -la ~/.tiup/storage/cluster/upgrade_precheck/reports/

# 检查权限
ls -ld ~/.tiup/storage/cluster/upgrade_precheck/reports/

# 检查日志
cat ~/.tiup/logs/tiup-cluster-debug-*.log | grep -i "report\|error"</pre>
                    </div>

                    <textarea class="remark-input" placeholder="添加测试备注..." data-id="phase-12-test-8.2-remark" onblur="saveRemark(this)"></textarea>
                    <div class="remark-display" data-id="phase-12-test-8.2-remark-display" style="display: none;"></div>
<h4>验证点</h4>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-12-test-8.2-cp1" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>内存使用合理</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 在另一个终端执行
  # ps aux | grep "tiup-cluster\|upgrade-precheck" | grep -v grep | awk '{print "Memory:", $6/1024 "MB"}'
  ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck &
  PID=$!
  sleep 5
  ps -p $PID -o rss= | awk '{print "Memory usage:", $1/1024 "MB"}'
  wait $PID</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-12-test-8.2-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-12-test-8.2-cp1-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-12-test-8.2-cp2" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>CPU 使用合理</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 在另一个终端执行
  # top -pid $(pgrep -f "tiup-cluster") -l 1 | grep "CPU usage"
  ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck &
  PID=$!
  sleep 5
  ps -p $PID -o %cpu= | awk '{print "CPU usage:", $1 "%"}'
  wait $PID</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-12-test-8.2-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-12-test-8.2-cp2-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-12-test-8.2-cp3" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>没有资源泄漏</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 执行多次 precheck，检查资源使用是否稳定
  for i in {1..3}; do
    echo "Run $i:"
    ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck > /dev/null 2>&1
    sleep 2
  done
  # 检查进程是否都正常退出
  ps aux | grep "tiup-cluster\|upgrade-precheck" | grep -v grep && echo "✗ Process still running" || echo "✓ All processes exited"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-12-test-8.2-cp3-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-12-test-8.2-cp3-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-12-test-8.2-cp4" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>TiUP 已安装或构建</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-12-test-8.2-cp4-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-12-test-8.2-cp4-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-12-test-8.2-cp5" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>tidb-upgrade-precheck 已构建</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-12-test-8.2-cp5-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-12-test-8.2-cp5-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-12-test-8.2-cp6" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>知识库已生成</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-12-test-8.2-cp6-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-12-test-8.2-cp6-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-12-test-8.2-cp7" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>测试集群已部署并运行</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-12-test-8.2-cp7-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-12-test-8.2-cp7-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-12-test-8.2-cp8" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>环境变量已设置</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-12-test-8.2-cp8-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-12-test-8.2-cp8-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-12-test-8.2-cp9" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 1.1: 基本 Precheck-Only 测试</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-12-test-8.2-cp9-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-12-test-8.2-cp9-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-12-test-8.2-cp10" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 1.2: Text 格式</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-12-test-8.2-cp10-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-12-test-8.2-cp10-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-12-test-8.2-cp11" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 1.3: HTML 格式</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-12-test-8.2-cp11-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-12-test-8.2-cp11-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-12-test-8.2-cp12" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 1.4: Markdown 格式</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-12-test-8.2-cp12-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-12-test-8.2-cp12-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-12-test-8.2-cp13" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 1.5: 自定义输出文件</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-12-test-8.2-cp13-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-12-test-8.2-cp13-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-12-test-8.2-cp14" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 2.1: 默认升级流程</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-12-test-8.2-cp14-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-12-test-8.2-cp14-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-12-test-8.2-cp15" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 2.2: HTML 报告</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-12-test-8.2-cp15-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-12-test-8.2-cp15-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-12-test-8.2-cp16" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 2.3: 跳过确认</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-12-test-8.2-cp16-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-12-test-8.2-cp16-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-12-test-8.2-cp17" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 3.1: 默认用户</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-12-test-8.2-cp17-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-12-test-8.2-cp17-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-12-test-8.2-cp18" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 3.2: 自定义用户</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-12-test-8.2-cp18-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-12-test-8.2-cp18-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-12-test-8.2-cp19" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 3.3: 密码提示</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-12-test-8.2-cp19-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-12-test-8.2-cp19-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-12-test-8.2-cp20" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 3.4: 密码文件</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-12-test-8.2-cp20-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-12-test-8.2-cp20-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-12-test-8.2-cp21" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 4.1: 创建配置文件</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-12-test-8.2-cp21-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-12-test-8.2-cp21-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-12-test-8.2-cp22" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 4.2: 使用自定义配置</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-12-test-8.2-cp22-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-12-test-8.2-cp22-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-12-test-8.2-cp23" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 4.3: 使用默认配置位置</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-12-test-8.2-cp23-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-12-test-8.2-cp23-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-12-test-8.2-cp24" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.1: 跳过 Precheck</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-12-test-8.2-cp24-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-12-test-8.2-cp24-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-12-test-8.2-cp25" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.2: Precheck 失败但继续</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-12-test-8.2-cp25-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-12-test-8.2-cp25-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-12-test-8.2-cp26" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.3: 无效集群名称</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-12-test-8.2-cp26-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-12-test-8.2-cp26-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-12-test-8.2-cp27" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.4: 无效目标版本</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-12-test-8.2-cp27-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-12-test-8.2-cp27-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-12-test-8.2-cp28" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.5: 缺少二进制路径</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-12-test-8.2-cp28-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-12-test-8.2-cp28-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-12-test-8.2-cp29" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.6: 缺少知识库路径</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-12-test-8.2-cp29-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-12-test-8.2-cp29-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-12-test-8.2-cp30" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 6.1: Text 报告内容</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-12-test-8.2-cp30-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-12-test-8.2-cp30-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-12-test-8.2-cp31" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 6.2: HTML 报告内容</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-12-test-8.2-cp31-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-12-test-8.2-cp31-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-12-test-8.2-cp32" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 6.3: JSON 报告内容</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-12-test-8.2-cp32-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-12-test-8.2-cp32-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-12-test-8.2-cp33" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 7.1: 拓扑文件生成</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-12-test-8.2-cp33-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-12-test-8.2-cp33-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-12-test-8.2-cp34" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 7.2: 命令参数传递</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-12-test-8.2-cp34-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-12-test-8.2-cp34-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-12-test-8.2-cp35" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 7.3: 工作目录</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-12-test-8.2-cp35-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-12-test-8.2-cp35-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-12-test-8.2-cp36" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 7.4: 报告路径提取</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-12-test-8.2-cp36-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-12-test-8.2-cp36-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-12-test-8.2-cp37" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 8.1: 执行时间</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-12-test-8.2-cp37-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-12-test-8.2-cp37-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-12-test-8.2-cp38" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 8.2: 资源使用</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-12-test-8.2-cp38-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-12-test-8.2-cp38-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-12-test-8.2-cp39" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>所有测试通过</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-12-test-8.2-cp39-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-12-test-8.2-cp39-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-12-test-8.2-cp40" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>部分测试通过</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-12-test-8.2-cp40-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-12-test-8.2-cp40-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-12-test-8.2-cp41" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>测试失败</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-12-test-8.2-cp41-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-12-test-8.2-cp41-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
</div>
</div></div>

        <div class="phase">
            <h3 class="collapsible" onclick="toggleSection(this)">Phase 5: 错误处理</h3>
            <p style="margin: 10px 0; color: #666;"><strong>目标:</strong> </p>
            <div class="collapsed-content">

                <div class="test">
                    <div class="test-header">
                        <input type="checkbox" class="test-checkbox" data-id="phase-13-test-8.2" onchange="updateProgress()">
                        <h4>Test 8.2: 资源使用</h4>
                    </div>

                    <div class="command-block">
                        <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                        <pre># 检查输出目录
ls -la ~/.tiup/storage/cluster/upgrade_precheck/reports/

# 检查权限
ls -ld ~/.tiup/storage/cluster/upgrade_precheck/reports/

# 检查日志
cat ~/.tiup/logs/tiup-cluster-debug-*.log | grep -i "report\|error"</pre>
                    </div>

                    <textarea class="remark-input" placeholder="添加测试备注..." data-id="phase-13-test-8.2-remark" onblur="saveRemark(this)"></textarea>
                    <div class="remark-display" data-id="phase-13-test-8.2-remark-display" style="display: none;"></div>
<h4>验证点</h4>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-13-test-8.2-cp1" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>内存使用合理</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 在另一个终端执行
  # ps aux | grep "tiup-cluster\|upgrade-precheck" | grep -v grep | awk '{print "Memory:", $6/1024 "MB"}'
  ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck &
  PID=$!
  sleep 5
  ps -p $PID -o rss= | awk '{print "Memory usage:", $1/1024 "MB"}'
  wait $PID</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-13-test-8.2-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-13-test-8.2-cp1-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-13-test-8.2-cp2" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>CPU 使用合理</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 在另一个终端执行
  # top -pid $(pgrep -f "tiup-cluster") -l 1 | grep "CPU usage"
  ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck &
  PID=$!
  sleep 5
  ps -p $PID -o %cpu= | awk '{print "CPU usage:", $1 "%"}'
  wait $PID</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-13-test-8.2-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-13-test-8.2-cp2-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-13-test-8.2-cp3" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>没有资源泄漏</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 执行多次 precheck，检查资源使用是否稳定
  for i in {1..3}; do
    echo "Run $i:"
    ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck > /dev/null 2>&1
    sleep 2
  done
  # 检查进程是否都正常退出
  ps aux | grep "tiup-cluster\|upgrade-precheck" | grep -v grep && echo "✗ Process still running" || echo "✓ All processes exited"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-13-test-8.2-cp3-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-13-test-8.2-cp3-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-13-test-8.2-cp4" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>TiUP 已安装或构建</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-13-test-8.2-cp4-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-13-test-8.2-cp4-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-13-test-8.2-cp5" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>tidb-upgrade-precheck 已构建</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-13-test-8.2-cp5-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-13-test-8.2-cp5-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-13-test-8.2-cp6" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>知识库已生成</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-13-test-8.2-cp6-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-13-test-8.2-cp6-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-13-test-8.2-cp7" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>测试集群已部署并运行</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-13-test-8.2-cp7-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-13-test-8.2-cp7-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-13-test-8.2-cp8" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>环境变量已设置</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-13-test-8.2-cp8-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-13-test-8.2-cp8-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-13-test-8.2-cp9" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 1.1: 基本 Precheck-Only 测试</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-13-test-8.2-cp9-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-13-test-8.2-cp9-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-13-test-8.2-cp10" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 1.2: Text 格式</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-13-test-8.2-cp10-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-13-test-8.2-cp10-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-13-test-8.2-cp11" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 1.3: HTML 格式</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-13-test-8.2-cp11-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-13-test-8.2-cp11-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-13-test-8.2-cp12" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 1.4: Markdown 格式</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-13-test-8.2-cp12-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-13-test-8.2-cp12-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-13-test-8.2-cp13" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 1.5: 自定义输出文件</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-13-test-8.2-cp13-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-13-test-8.2-cp13-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-13-test-8.2-cp14" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 2.1: 默认升级流程</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-13-test-8.2-cp14-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-13-test-8.2-cp14-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-13-test-8.2-cp15" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 2.2: HTML 报告</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-13-test-8.2-cp15-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-13-test-8.2-cp15-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-13-test-8.2-cp16" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 2.3: 跳过确认</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-13-test-8.2-cp16-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-13-test-8.2-cp16-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-13-test-8.2-cp17" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 3.1: 默认用户</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-13-test-8.2-cp17-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-13-test-8.2-cp17-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-13-test-8.2-cp18" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 3.2: 自定义用户</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-13-test-8.2-cp18-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-13-test-8.2-cp18-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-13-test-8.2-cp19" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 3.3: 密码提示</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-13-test-8.2-cp19-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-13-test-8.2-cp19-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-13-test-8.2-cp20" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 3.4: 密码文件</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-13-test-8.2-cp20-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-13-test-8.2-cp20-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-13-test-8.2-cp21" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 4.1: 创建配置文件</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-13-test-8.2-cp21-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-13-test-8.2-cp21-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-13-test-8.2-cp22" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 4.2: 使用自定义配置</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-13-test-8.2-cp22-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-13-test-8.2-cp22-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-13-test-8.2-cp23" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 4.3: 使用默认配置位置</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-13-test-8.2-cp23-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-13-test-8.2-cp23-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-13-test-8.2-cp24" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.1: 跳过 Precheck</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-13-test-8.2-cp24-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-13-test-8.2-cp24-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-13-test-8.2-cp25" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.2: Precheck 失败但继续</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-13-test-8.2-cp25-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-13-test-8.2-cp25-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-13-test-8.2-cp26" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.3: 无效集群名称</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-13-test-8.2-cp26-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-13-test-8.2-cp26-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-13-test-8.2-cp27" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.4: 无效目标版本</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-13-test-8.2-cp27-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-13-test-8.2-cp27-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-13-test-8.2-cp28" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.5: 缺少二进制路径</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-13-test-8.2-cp28-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-13-test-8.2-cp28-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-13-test-8.2-cp29" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.6: 缺少知识库路径</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-13-test-8.2-cp29-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-13-test-8.2-cp29-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-13-test-8.2-cp30" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 6.1: Text 报告内容</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-13-test-8.2-cp30-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-13-test-8.2-cp30-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-13-test-8.2-cp31" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 6.2: HTML 报告内容</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-13-test-8.2-cp31-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-13-test-8.2-cp31-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-13-test-8.2-cp32" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 6.3: JSON 报告内容</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-13-test-8.2-cp32-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-13-test-8.2-cp32-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-13-test-8.2-cp33" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 7.1: 拓扑文件生成</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-13-test-8.2-cp33-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-13-test-8.2-cp33-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-13-test-8.2-cp34" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 7.2: 命令参数传递</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-13-test-8.2-cp34-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-13-test-8.2-cp34-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-13-test-8.2-cp35" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 7.3: 工作目录</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-13-test-8.2-cp35-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-13-test-8.2-cp35-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-13-test-8.2-cp36" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 7.4: 报告路径提取</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-13-test-8.2-cp36-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-13-test-8.2-cp36-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-13-test-8.2-cp37" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 8.1: 执行时间</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-13-test-8.2-cp37-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-13-test-8.2-cp37-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-13-test-8.2-cp38" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 8.2: 资源使用</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-13-test-8.2-cp38-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-13-test-8.2-cp38-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-13-test-8.2-cp39" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>所有测试通过</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-13-test-8.2-cp39-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-13-test-8.2-cp39-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-13-test-8.2-cp40" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>部分测试通过</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-13-test-8.2-cp40-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-13-test-8.2-cp40-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-13-test-8.2-cp41" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>测试失败</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-13-test-8.2-cp41-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-13-test-8.2-cp41-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
</div>
</div></div>

        <div class="phase">
            <h3 class="collapsible" onclick="toggleSection(this)">Phase 6: 报告验证</h3>
            <p style="margin: 10px 0; color: #666;"><strong>目标:</strong> </p>
            <div class="collapsed-content">

                <div class="test">
                    <div class="test-header">
                        <input type="checkbox" class="test-checkbox" data-id="phase-14-test-8.2" onchange="updateProgress()">
                        <h4>Test 8.2: 资源使用</h4>
                    </div>

                    <div class="command-block">
                        <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                        <pre># 检查输出目录
ls -la ~/.tiup/storage/cluster/upgrade_precheck/reports/

# 检查权限
ls -ld ~/.tiup/storage/cluster/upgrade_precheck/reports/

# 检查日志
cat ~/.tiup/logs/tiup-cluster-debug-*.log | grep -i "report\|error"</pre>
                    </div>

                    <textarea class="remark-input" placeholder="添加测试备注..." data-id="phase-14-test-8.2-remark" onblur="saveRemark(this)"></textarea>
                    <div class="remark-display" data-id="phase-14-test-8.2-remark-display" style="display: none;"></div>
<h4>验证点</h4>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-14-test-8.2-cp1" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>内存使用合理</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 在另一个终端执行
  # ps aux | grep "tiup-cluster\|upgrade-precheck" | grep -v grep | awk '{print "Memory:", $6/1024 "MB"}'
  ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck &
  PID=$!
  sleep 5
  ps -p $PID -o rss= | awk '{print "Memory usage:", $1/1024 "MB"}'
  wait $PID</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-14-test-8.2-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-14-test-8.2-cp1-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-14-test-8.2-cp2" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>CPU 使用合理</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 在另一个终端执行
  # top -pid $(pgrep -f "tiup-cluster") -l 1 | grep "CPU usage"
  ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck &
  PID=$!
  sleep 5
  ps -p $PID -o %cpu= | awk '{print "CPU usage:", $1 "%"}'
  wait $PID</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-14-test-8.2-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-14-test-8.2-cp2-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-14-test-8.2-cp3" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>没有资源泄漏</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 执行多次 precheck，检查资源使用是否稳定
  for i in {1..3}; do
    echo "Run $i:"
    ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck > /dev/null 2>&1
    sleep 2
  done
  # 检查进程是否都正常退出
  ps aux | grep "tiup-cluster\|upgrade-precheck" | grep -v grep && echo "✗ Process still running" || echo "✓ All processes exited"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-14-test-8.2-cp3-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-14-test-8.2-cp3-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-14-test-8.2-cp4" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>TiUP 已安装或构建</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-14-test-8.2-cp4-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-14-test-8.2-cp4-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-14-test-8.2-cp5" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>tidb-upgrade-precheck 已构建</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-14-test-8.2-cp5-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-14-test-8.2-cp5-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-14-test-8.2-cp6" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>知识库已生成</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-14-test-8.2-cp6-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-14-test-8.2-cp6-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-14-test-8.2-cp7" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>测试集群已部署并运行</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-14-test-8.2-cp7-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-14-test-8.2-cp7-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-14-test-8.2-cp8" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>环境变量已设置</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-14-test-8.2-cp8-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-14-test-8.2-cp8-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-14-test-8.2-cp9" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 1.1: 基本 Precheck-Only 测试</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-14-test-8.2-cp9-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-14-test-8.2-cp9-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-14-test-8.2-cp10" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 1.2: Text 格式</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-14-test-8.2-cp10-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-14-test-8.2-cp10-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-14-test-8.2-cp11" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 1.3: HTML 格式</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-14-test-8.2-cp11-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-14-test-8.2-cp11-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-14-test-8.2-cp12" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 1.4: Markdown 格式</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-14-test-8.2-cp12-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-14-test-8.2-cp12-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-14-test-8.2-cp13" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 1.5: 自定义输出文件</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-14-test-8.2-cp13-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-14-test-8.2-cp13-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-14-test-8.2-cp14" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 2.1: 默认升级流程</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-14-test-8.2-cp14-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-14-test-8.2-cp14-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-14-test-8.2-cp15" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 2.2: HTML 报告</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-14-test-8.2-cp15-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-14-test-8.2-cp15-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-14-test-8.2-cp16" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 2.3: 跳过确认</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-14-test-8.2-cp16-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-14-test-8.2-cp16-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-14-test-8.2-cp17" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 3.1: 默认用户</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-14-test-8.2-cp17-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-14-test-8.2-cp17-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-14-test-8.2-cp18" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 3.2: 自定义用户</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-14-test-8.2-cp18-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-14-test-8.2-cp18-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-14-test-8.2-cp19" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 3.3: 密码提示</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-14-test-8.2-cp19-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-14-test-8.2-cp19-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-14-test-8.2-cp20" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 3.4: 密码文件</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-14-test-8.2-cp20-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-14-test-8.2-cp20-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-14-test-8.2-cp21" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 4.1: 创建配置文件</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-14-test-8.2-cp21-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-14-test-8.2-cp21-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-14-test-8.2-cp22" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 4.2: 使用自定义配置</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-14-test-8.2-cp22-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-14-test-8.2-cp22-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-14-test-8.2-cp23" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 4.3: 使用默认配置位置</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-14-test-8.2-cp23-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-14-test-8.2-cp23-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-14-test-8.2-cp24" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.1: 跳过 Precheck</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-14-test-8.2-cp24-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-14-test-8.2-cp24-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-14-test-8.2-cp25" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.2: Precheck 失败但继续</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-14-test-8.2-cp25-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-14-test-8.2-cp25-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-14-test-8.2-cp26" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.3: 无效集群名称</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-14-test-8.2-cp26-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-14-test-8.2-cp26-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-14-test-8.2-cp27" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.4: 无效目标版本</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-14-test-8.2-cp27-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-14-test-8.2-cp27-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-14-test-8.2-cp28" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.5: 缺少二进制路径</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-14-test-8.2-cp28-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-14-test-8.2-cp28-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-14-test-8.2-cp29" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.6: 缺少知识库路径</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-14-test-8.2-cp29-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-14-test-8.2-cp29-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-14-test-8.2-cp30" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 6.1: Text 报告内容</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-14-test-8.2-cp30-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-14-test-8.2-cp30-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-14-test-8.2-cp31" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 6.2: HTML 报告内容</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-14-test-8.2-cp31-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-14-test-8.2-cp31-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-14-test-8.2-cp32" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 6.3: JSON 报告内容</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-14-test-8.2-cp32-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-14-test-8.2-cp32-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-14-test-8.2-cp33" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 7.1: 拓扑文件生成</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-14-test-8.2-cp33-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-14-test-8.2-cp33-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-14-test-8.2-cp34" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 7.2: 命令参数传递</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-14-test-8.2-cp34-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-14-test-8.2-cp34-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-14-test-8.2-cp35" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 7.3: 工作目录</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-14-test-8.2-cp35-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-14-test-8.2-cp35-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-14-test-8.2-cp36" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 7.4: 报告路径提取</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-14-test-8.2-cp36-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-14-test-8.2-cp36-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-14-test-8.2-cp37" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 8.1: 执行时间</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-14-test-8.2-cp37-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-14-test-8.2-cp37-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-14-test-8.2-cp38" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 8.2: 资源使用</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-14-test-8.2-cp38-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-14-test-8.2-cp38-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-14-test-8.2-cp39" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>所有测试通过</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-14-test-8.2-cp39-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-14-test-8.2-cp39-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-14-test-8.2-cp40" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>部分测试通过</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-14-test-8.2-cp40-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-14-test-8.2-cp40-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-14-test-8.2-cp41" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>测试失败</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-14-test-8.2-cp41-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-14-test-8.2-cp41-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
</div>
</div></div>

        <div class="phase">
            <h3 class="collapsible" onclick="toggleSection(this)">Phase 7: 集成验证</h3>
            <p style="margin: 10px 0; color: #666;"><strong>目标:</strong> </p>
            <div class="collapsed-content">

                <div class="test">
                    <div class="test-header">
                        <input type="checkbox" class="test-checkbox" data-id="phase-15-test-8.2" onchange="updateProgress()">
                        <h4>Test 8.2: 资源使用</h4>
                    </div>

                    <div class="command-block">
                        <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                        <pre># 检查输出目录
ls -la ~/.tiup/storage/cluster/upgrade_precheck/reports/

# 检查权限
ls -ld ~/.tiup/storage/cluster/upgrade_precheck/reports/

# 检查日志
cat ~/.tiup/logs/tiup-cluster-debug-*.log | grep -i "report\|error"</pre>
                    </div>

                    <textarea class="remark-input" placeholder="添加测试备注..." data-id="phase-15-test-8.2-remark" onblur="saveRemark(this)"></textarea>
                    <div class="remark-display" data-id="phase-15-test-8.2-remark-display" style="display: none;"></div>
<h4>验证点</h4>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-15-test-8.2-cp1" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>内存使用合理</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 在另一个终端执行
  # ps aux | grep "tiup-cluster\|upgrade-precheck" | grep -v grep | awk '{print "Memory:", $6/1024 "MB"}'
  ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck &
  PID=$!
  sleep 5
  ps -p $PID -o rss= | awk '{print "Memory usage:", $1/1024 "MB"}'
  wait $PID</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-15-test-8.2-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-15-test-8.2-cp1-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-15-test-8.2-cp2" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>CPU 使用合理</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 在另一个终端执行
  # top -pid $(pgrep -f "tiup-cluster") -l 1 | grep "CPU usage"
  ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck &
  PID=$!
  sleep 5
  ps -p $PID -o %cpu= | awk '{print "CPU usage:", $1 "%"}'
  wait $PID</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-15-test-8.2-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-15-test-8.2-cp2-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-15-test-8.2-cp3" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>没有资源泄漏</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 执行多次 precheck，检查资源使用是否稳定
  for i in {1..3}; do
    echo "Run $i:"
    ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck > /dev/null 2>&1
    sleep 2
  done
  # 检查进程是否都正常退出
  ps aux | grep "tiup-cluster\|upgrade-precheck" | grep -v grep && echo "✗ Process still running" || echo "✓ All processes exited"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-15-test-8.2-cp3-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-15-test-8.2-cp3-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-15-test-8.2-cp4" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>TiUP 已安装或构建</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-15-test-8.2-cp4-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-15-test-8.2-cp4-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-15-test-8.2-cp5" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>tidb-upgrade-precheck 已构建</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-15-test-8.2-cp5-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-15-test-8.2-cp5-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-15-test-8.2-cp6" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>知识库已生成</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-15-test-8.2-cp6-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-15-test-8.2-cp6-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-15-test-8.2-cp7" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>测试集群已部署并运行</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-15-test-8.2-cp7-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-15-test-8.2-cp7-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-15-test-8.2-cp8" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>环境变量已设置</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-15-test-8.2-cp8-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-15-test-8.2-cp8-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-15-test-8.2-cp9" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 1.1: 基本 Precheck-Only 测试</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-15-test-8.2-cp9-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-15-test-8.2-cp9-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-15-test-8.2-cp10" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 1.2: Text 格式</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-15-test-8.2-cp10-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-15-test-8.2-cp10-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-15-test-8.2-cp11" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 1.3: HTML 格式</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-15-test-8.2-cp11-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-15-test-8.2-cp11-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-15-test-8.2-cp12" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 1.4: Markdown 格式</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-15-test-8.2-cp12-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-15-test-8.2-cp12-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-15-test-8.2-cp13" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 1.5: 自定义输出文件</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-15-test-8.2-cp13-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-15-test-8.2-cp13-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-15-test-8.2-cp14" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 2.1: 默认升级流程</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-15-test-8.2-cp14-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-15-test-8.2-cp14-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-15-test-8.2-cp15" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 2.2: HTML 报告</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-15-test-8.2-cp15-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-15-test-8.2-cp15-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-15-test-8.2-cp16" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 2.3: 跳过确认</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-15-test-8.2-cp16-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-15-test-8.2-cp16-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-15-test-8.2-cp17" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 3.1: 默认用户</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-15-test-8.2-cp17-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-15-test-8.2-cp17-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-15-test-8.2-cp18" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 3.2: 自定义用户</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-15-test-8.2-cp18-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-15-test-8.2-cp18-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-15-test-8.2-cp19" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 3.3: 密码提示</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-15-test-8.2-cp19-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-15-test-8.2-cp19-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-15-test-8.2-cp20" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 3.4: 密码文件</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-15-test-8.2-cp20-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-15-test-8.2-cp20-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-15-test-8.2-cp21" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 4.1: 创建配置文件</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-15-test-8.2-cp21-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-15-test-8.2-cp21-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-15-test-8.2-cp22" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 4.2: 使用自定义配置</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-15-test-8.2-cp22-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-15-test-8.2-cp22-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-15-test-8.2-cp23" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 4.3: 使用默认配置位置</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-15-test-8.2-cp23-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-15-test-8.2-cp23-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-15-test-8.2-cp24" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.1: 跳过 Precheck</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-15-test-8.2-cp24-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-15-test-8.2-cp24-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-15-test-8.2-cp25" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.2: Precheck 失败但继续</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-15-test-8.2-cp25-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-15-test-8.2-cp25-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-15-test-8.2-cp26" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.3: 无效集群名称</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-15-test-8.2-cp26-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-15-test-8.2-cp26-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-15-test-8.2-cp27" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.4: 无效目标版本</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-15-test-8.2-cp27-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-15-test-8.2-cp27-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-15-test-8.2-cp28" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.5: 缺少二进制路径</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-15-test-8.2-cp28-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-15-test-8.2-cp28-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-15-test-8.2-cp29" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.6: 缺少知识库路径</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-15-test-8.2-cp29-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-15-test-8.2-cp29-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-15-test-8.2-cp30" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 6.1: Text 报告内容</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-15-test-8.2-cp30-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-15-test-8.2-cp30-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-15-test-8.2-cp31" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 6.2: HTML 报告内容</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-15-test-8.2-cp31-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-15-test-8.2-cp31-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-15-test-8.2-cp32" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 6.3: JSON 报告内容</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-15-test-8.2-cp32-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-15-test-8.2-cp32-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-15-test-8.2-cp33" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 7.1: 拓扑文件生成</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-15-test-8.2-cp33-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-15-test-8.2-cp33-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-15-test-8.2-cp34" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 7.2: 命令参数传递</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-15-test-8.2-cp34-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-15-test-8.2-cp34-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-15-test-8.2-cp35" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 7.3: 工作目录</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-15-test-8.2-cp35-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-15-test-8.2-cp35-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-15-test-8.2-cp36" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 7.4: 报告路径提取</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-15-test-8.2-cp36-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-15-test-8.2-cp36-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-15-test-8.2-cp37" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 8.1: 执行时间</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-15-test-8.2-cp37-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-15-test-8.2-cp37-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-15-test-8.2-cp38" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 8.2: 资源使用</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-15-test-8.2-cp38-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-15-test-8.2-cp38-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-15-test-8.2-cp39" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>所有测试通过</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-15-test-8.2-cp39-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-15-test-8.2-cp39-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-15-test-8.2-cp40" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>部分测试通过</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-15-test-8.2-cp40-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-15-test-8.2-cp40-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-15-test-8.2-cp41" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>测试失败</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-15-test-8.2-cp41-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-15-test-8.2-cp41-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
</div>
</div></div>

        <div class="phase">
            <h3 class="collapsible" onclick="toggleSection(this)">Phase 8: 性能测试</h3>
            <p style="margin: 10px 0; color: #666;"><strong>目标:</strong> </p>
            <div class="collapsed-content">

                <div class="test">
                    <div class="test-header">
                        <input type="checkbox" class="test-checkbox" data-id="phase-16-test-8.2" onchange="updateProgress()">
                        <h4>Test 8.2: 资源使用</h4>
                    </div>

                    <div class="command-block">
                        <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                        <pre># 检查输出目录
ls -la ~/.tiup/storage/cluster/upgrade_precheck/reports/

# 检查权限
ls -ld ~/.tiup/storage/cluster/upgrade_precheck/reports/

# 检查日志
cat ~/.tiup/logs/tiup-cluster-debug-*.log | grep -i "report\|error"</pre>
                    </div>

                    <textarea class="remark-input" placeholder="添加测试备注..." data-id="phase-16-test-8.2-remark" onblur="saveRemark(this)"></textarea>
                    <div class="remark-display" data-id="phase-16-test-8.2-remark-display" style="display: none;"></div>
<h4>验证点</h4>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-16-test-8.2-cp1" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>内存使用合理</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 在另一个终端执行
  # ps aux | grep "tiup-cluster\|upgrade-precheck" | grep -v grep | awk '{print "Memory:", $6/1024 "MB"}'
  ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck &
  PID=$!
  sleep 5
  ps -p $PID -o rss= | awk '{print "Memory usage:", $1/1024 "MB"}'
  wait $PID</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-16-test-8.2-cp1-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-16-test-8.2-cp1-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-16-test-8.2-cp2" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>CPU 使用合理</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 在另一个终端执行
  # top -pid $(pgrep -f "tiup-cluster") -l 1 | grep "CPU usage"
  ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck &
  PID=$!
  sleep 5
  ps -p $PID -o %cpu= | awk '{print "CPU usage:", $1 "%"}'
  wait $PID</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-16-test-8.2-cp2-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-16-test-8.2-cp2-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-16-test-8.2-cp3" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>没有资源泄漏</strong>
                                
                            <div class="command-block" style="margin-top: 5px;">
                                <button class="copy-btn" onclick="copyCommand(this)">复制</button>
                                <pre># 执行多次 precheck，检查资源使用是否稳定
  for i in {1..3}; do
    echo "Run $i:"
    ./bin/tiup-cluster upgrade e2e-test-cluster v8.5.4 --precheck > /dev/null 2>&1
    sleep 2
  done
  # 检查进程是否都正常退出
  ps aux | grep "tiup-cluster\|upgrade-precheck" | grep -v grep && echo "✗ Process still running" || echo "✓ All processes exited"</pre>
                            </div>

                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-16-test-8.2-cp3-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-16-test-8.2-cp3-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-16-test-8.2-cp4" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>TiUP 已安装或构建</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-16-test-8.2-cp4-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-16-test-8.2-cp4-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-16-test-8.2-cp5" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>tidb-upgrade-precheck 已构建</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-16-test-8.2-cp5-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-16-test-8.2-cp5-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-16-test-8.2-cp6" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>知识库已生成</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-16-test-8.2-cp6-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-16-test-8.2-cp6-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-16-test-8.2-cp7" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>测试集群已部署并运行</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-16-test-8.2-cp7-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-16-test-8.2-cp7-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-16-test-8.2-cp8" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>环境变量已设置</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-16-test-8.2-cp8-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-16-test-8.2-cp8-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-16-test-8.2-cp9" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 1.1: 基本 Precheck-Only 测试</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-16-test-8.2-cp9-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-16-test-8.2-cp9-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-16-test-8.2-cp10" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 1.2: Text 格式</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-16-test-8.2-cp10-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-16-test-8.2-cp10-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-16-test-8.2-cp11" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 1.3: HTML 格式</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-16-test-8.2-cp11-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-16-test-8.2-cp11-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-16-test-8.2-cp12" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 1.4: Markdown 格式</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-16-test-8.2-cp12-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-16-test-8.2-cp12-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-16-test-8.2-cp13" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 1.5: 自定义输出文件</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-16-test-8.2-cp13-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-16-test-8.2-cp13-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-16-test-8.2-cp14" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 2.1: 默认升级流程</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-16-test-8.2-cp14-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-16-test-8.2-cp14-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-16-test-8.2-cp15" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 2.2: HTML 报告</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-16-test-8.2-cp15-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-16-test-8.2-cp15-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-16-test-8.2-cp16" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 2.3: 跳过确认</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-16-test-8.2-cp16-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-16-test-8.2-cp16-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-16-test-8.2-cp17" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 3.1: 默认用户</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-16-test-8.2-cp17-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-16-test-8.2-cp17-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-16-test-8.2-cp18" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 3.2: 自定义用户</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-16-test-8.2-cp18-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-16-test-8.2-cp18-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-16-test-8.2-cp19" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 3.3: 密码提示</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-16-test-8.2-cp19-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-16-test-8.2-cp19-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-16-test-8.2-cp20" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 3.4: 密码文件</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-16-test-8.2-cp20-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-16-test-8.2-cp20-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-16-test-8.2-cp21" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 4.1: 创建配置文件</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-16-test-8.2-cp21-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-16-test-8.2-cp21-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-16-test-8.2-cp22" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 4.2: 使用自定义配置</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-16-test-8.2-cp22-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-16-test-8.2-cp22-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-16-test-8.2-cp23" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 4.3: 使用默认配置位置</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-16-test-8.2-cp23-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-16-test-8.2-cp23-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-16-test-8.2-cp24" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.1: 跳过 Precheck</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-16-test-8.2-cp24-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-16-test-8.2-cp24-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-16-test-8.2-cp25" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.2: Precheck 失败但继续</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-16-test-8.2-cp25-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-16-test-8.2-cp25-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-16-test-8.2-cp26" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.3: 无效集群名称</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-16-test-8.2-cp26-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-16-test-8.2-cp26-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-16-test-8.2-cp27" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.4: 无效目标版本</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-16-test-8.2-cp27-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-16-test-8.2-cp27-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-16-test-8.2-cp28" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.5: 缺少二进制路径</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-16-test-8.2-cp28-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-16-test-8.2-cp28-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-16-test-8.2-cp29" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 5.6: 缺少知识库路径</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-16-test-8.2-cp29-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-16-test-8.2-cp29-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-16-test-8.2-cp30" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 6.1: Text 报告内容</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-16-test-8.2-cp30-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-16-test-8.2-cp30-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-16-test-8.2-cp31" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 6.2: HTML 报告内容</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-16-test-8.2-cp31-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-16-test-8.2-cp31-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-16-test-8.2-cp32" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 6.3: JSON 报告内容</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-16-test-8.2-cp32-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-16-test-8.2-cp32-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-16-test-8.2-cp33" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 7.1: 拓扑文件生成</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-16-test-8.2-cp33-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-16-test-8.2-cp33-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-16-test-8.2-cp34" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 7.2: 命令参数传递</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-16-test-8.2-cp34-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-16-test-8.2-cp34-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-16-test-8.2-cp35" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 7.3: 工作目录</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-16-test-8.2-cp35-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-16-test-8.2-cp35-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-16-test-8.2-cp36" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 7.4: 报告路径提取</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-16-test-8.2-cp36-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-16-test-8.2-cp36-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-16-test-8.2-cp37" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 8.1: 执行时间</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-16-test-8.2-cp37-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-16-test-8.2-cp37-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-16-test-8.2-cp38" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>Test 8.2: 资源使用</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-16-test-8.2-cp38-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-16-test-8.2-cp38-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-16-test-8.2-cp39" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>所有测试通过</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-16-test-8.2-cp39-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-16-test-8.2-cp39-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-16-test-8.2-cp40" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>部分测试通过</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-16-test-8.2-cp40-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-16-test-8.2-cp40-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="checkpoint">
                        <div class="checkpoint-item">
                            <input type="checkbox" class="checkpoint-checkbox" data-id="phase-16-test-8.2-cp41" onchange="updateProgress()">
                            <div class="checkpoint-text">
                                <strong>测试失败</strong>
                                
                                <textarea class="remark-input" placeholder="添加备注..." data-id="phase-16-test-8.2-cp41-remark" onblur="saveRemark(this)" style="margin-top: 5px;"></textarea>
                                <div class="remark-display" data-id="phase-16-test-8.2-cp41-remark-display" style="display: none;"></div>
                            </div>
                        </div>
                    </div>
</div>
</div></div>

    </div>
    
    <button class="save-btn" onclick="saveAll()">💾 保存进度</button>
    <div class="save-indicator" id="saveIndicator">已保存</div>
    
    <script>
        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            loadProgress();
            updateProgress();
        });
        
        // 切换折叠
        function toggleSection(element) {
            const content = element.nextElementSibling;
            if (content && content.classList.contains('collapsed-content')) {
                element.classList.toggle('collapsed');
                content.style.display = content.style.display === 'none' ? 'block' : 'none';
            } else {
                // 查找下一个兄弟元素
                let next = element.nextElementSibling;
                while (next && !next.classList.contains('collapsed-content')) {
                    next = next.nextElementSibling;
                }
                if (next) {
                    element.classList.toggle('collapsed');
                    next.style.display = next.style.display === 'none' ? 'block' : 'none';
                }
            }
        }
        
        // 复制命令
        function copyCommand(btn) {
            const pre = btn.nextElementSibling;
            const text = pre.textContent;
            navigator.clipboard.writeText(text).then(() => {
                const originalText = btn.textContent;
                btn.textContent = '已复制!';
                setTimeout(() => {
                    btn.textContent = originalText;
                }, 2000);
            }).catch(() => {
                // 降级方案
                const textarea = document.createElement('textarea');
                textarea.value = text;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                btn.textContent = '已复制!';
                setTimeout(() => {
                    btn.textContent = '复制';
                }, 2000);
            });
        }
        
        // 保存备注
        function saveRemark(textarea) {
            const remarkId = textarea.dataset.id;
            const remark = textarea.value.trim();
            localStorage.setItem(`remark_${remarkId}`, remark);
            
            const display = document.querySelector(`[data-id="${remarkId}-display"]`);
            if (remark) {
                display.textContent = remark;
                display.style.display = 'block';
                textarea.style.display = 'none';
            } else {
                display.style.display = 'none';
                textarea.style.display = 'block';
            }
        }
        
        // 加载备注
        function loadRemark(remarkId) {
            const remark = localStorage.getItem(`remark_${remarkId}`);
            if (remark) {
                const textarea = document.querySelector(`[data-id="${remarkId}"]`);
                const display = document.querySelector(`[data-id="${remarkId}-display"]`);
                if (textarea && display) {
                    textarea.value = remark;
                    display.textContent = remark;
                    display.style.display = 'block';
                    textarea.style.display = 'none';
                }
            }
        }
        
        // 保存进度
        function saveAll() {
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            checkboxes.forEach(cb => {
                localStorage.setItem(`check_${cb.dataset.id}`, cb.checked);
            });
            
            // 保存所有备注
            const textareas = document.querySelectorAll('.remark-input');
            textareas.forEach(ta => {
                const remarkId = ta.dataset.id;
                const remark = ta.value.trim();
                if (remark) {
                    localStorage.setItem(`remark_${remarkId}`, remark);
                }
            });
            
            // 显示保存提示
            const indicator = document.getElementById('saveIndicator');
            indicator.classList.add('show');
            setTimeout(() => {
                indicator.classList.remove('show');
            }, 2000);
        }
        
        // 加载进度
        function loadProgress() {
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            checkboxes.forEach(cb => {
                const saved = localStorage.getItem(`check_${cb.dataset.id}`);
                if (saved === 'true') {
                    cb.checked = true;
                }
            });
            
            // 加载所有备注
            const textareas = document.querySelectorAll('.remark-input');
            textareas.forEach(ta => {
                loadRemark(ta.dataset.id);
            });
        }
        
        // 更新进度
        function updateProgress() {
            const allCheckboxes = document.querySelectorAll('input[type="checkbox"]');
            const checked = document.querySelectorAll('input[type="checkbox"]:checked');
            
            const total = allCheckboxes.length;
            const completed = checked.length;
            const percent = total > 0 ? Math.round((completed / total) * 100) : 0;
            
            document.getElementById('totalTests').textContent = total;
            document.getElementById('completedTests').textContent = completed;
            document.getElementById('progressPercent').textContent = percent + '%';
            document.getElementById('progressFill').style.width = percent + '%';
            
            // 自动保存
            saveAll();
        }
        
        // 定期自动保存
        setInterval(saveAll, 30000); // 每30秒自动保存
    </script>
</body>
</html>
